{"version":3,"file":"animation-timeline.js","mappings":"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","sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./src/timelineEventsEmitter.ts","webpack:///./src/enums/timelineKeyframeShape.ts","webpack:///./src/utils/timelineStyleUtils.ts","webpack:///./src/utils/timelineUtils.ts","webpack:///./src/utils/events/timelineBaseEvent.ts","webpack:///./src/utils/events/timelineKeyframeChangedEvent.ts","webpack:///./src/enums/timelineEventSource.ts","webpack:///./src/utils/events/timelineTimeChangedEvent.ts","webpack:///./src/utils/events/timelineSelectedEvent.ts","webpack:///./src/utils/events/timelineClickEvent.ts","webpack:///./src/utils/events/timelineDragEvent.ts","webpack:///./src/enums/timelineInteractionMode.ts","webpack:///./src/enums/timelineElementType.ts","webpack:///./src/enums/timelineCursorType.ts","webpack:///./src/enums/timelineCapShape.ts","webpack:///./src/enums/timelineSelectionMode.ts","webpack:///./src/enums/timelineEvents.ts","webpack:///./src/settings/defaults.ts","webpack:///./src/enums/timelineScrollSource.ts","webpack:///./src/timeline.ts","webpack:///./src/animation-timeline.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"timelineModule\"] = factory();\n\telse\n\t\troot[\"timelineModule\"] = factory();\n})(self, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/* eslint-disable  @typescript-eslint/no-explicit-any */\ninterface Event {\n  topic: string;\n  callback: (args: any) => void;\n}\n\nexport class TimelineEventsEmitter {\n  protected _subscriptions: Array<Event> = [];\n\n  // on event.\n  on(topic: string, callback: (args: any) => void): void {\n    if (!callback) {\n      return;\n    }\n\n    this._subscriptions.push({\n      topic: topic,\n      callback: callback,\n    });\n  }\n  /**\n   * Remove an event from the subscriptions list.\n   */\n  off(topic: string, callback: (args: any) => void): void {\n    this._subscriptions = this._subscriptions.filter((event) => {\n      return event && event.callback != callback && event.topic != topic;\n    });\n  }\n\n  /**\n   * Unsubscribe all\n   */\n  offAll(): void {\n    this._subscriptions.length = 0;\n  }\n\n  // emit event.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  emit(topic: string, args: any): void {\n    this._subscriptions.forEach((event) => {\n      if (event && event.topic == topic && event.callback) {\n        event.callback(args);\n      }\n    });\n  }\n}\n","export enum TimelineKeyframeShape {\n  None = 'none',\n  Rhomb = 'rhomb',\n  Circle = 'circle',\n  Rect = 'rect',\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { TimelineRow } from '../timelineRow';\nimport { TimelineOptions } from '../settings/timelineOptions';\nimport { TimelineRowStyle } from '../settings/styles/timelineRowStyle';\nimport { TimelineKeyframeStyle } from '../settings/styles/timelineKeyframeStyle';\nimport { TimelineKeyframeShape } from '../enums/timelineKeyframeShape';\n\nexport class TimelineStyleUtils {\n  /**\n   * Get keyframe style from a keyframe, than from a row, than from a global settings.\n   * @param keyframe keyframe to get style for.\n   * @param row keyframe row.\n   * @param propertyName property to get.\n   * @param defaultValue default value to return\n   * @param reverseOrder reverse styling order: global, row, keyframe\n   */\n  static getKeyframeStyle<T>(\n    keyframeStyle: TimelineKeyframeStyle | null,\n    rowStyle: TimelineRow | null,\n    options: TimelineOptions | null,\n    propertyName: string,\n    defaultValue?: T,\n    reverseOrder = false,\n  ): T {\n    // Don't spawn new array for the normal order.\n    let styles: Array<any> | null = null;\n    if (keyframeStyle) {\n      const style: any = keyframeStyle;\n      if (style[propertyName] !== undefined) {\n        const value = style[propertyName];\n        if (!reverseOrder) {\n          return value;\n        }\n        styles = styles || [];\n        styles.push(value);\n      }\n    }\n\n    if (rowStyle && rowStyle.keyframesStyle) {\n      const style: any = rowStyle.keyframesStyle;\n      if (style[propertyName] !== undefined) {\n        const value = style[propertyName];\n        if (!reverseOrder) {\n          return value;\n        }\n        styles = styles || [];\n        styles.push(value);\n      }\n    }\n    const globalRowStyle = options ? options.rowsStyle : null;\n    if (globalRowStyle && globalRowStyle.keyframesStyle) {\n      const style: any = globalRowStyle.keyframesStyle;\n      if (style[propertyName] !== undefined) {\n        const value = style[propertyName];\n        if (!reverseOrder) {\n          return value;\n        }\n        styles = styles || [];\n        styles.push(value);\n      }\n    }\n\n    return reverseOrder && styles && styles.length > 0 ? styles[styles.length - 1] : defaultValue;\n  }\n\n  /**\n   * Get row style from default settings or overrides by a row settings.\n   */\n  static getRowStyle<T>(rowStyle: TimelineRowStyle, options: TimelineOptions | null, propertyName: string, defaultValue?: T, reverseOrder = false): T | undefined {\n    // Don't spawn new array for the normal order.\n    let styles: Array<any> = null;\n    if (rowStyle) {\n      const style: any = rowStyle;\n      if (style[propertyName] !== undefined) {\n        const results = style[propertyName] as T;\n        if (!reverseOrder) {\n          return results;\n        }\n        styles = styles || [];\n        styles.push(results);\n      }\n    }\n    const globalRowStyle = options ? options.rowsStyle : null;\n    if (globalRowStyle) {\n      const style: any = globalRowStyle;\n      if (style[propertyName] !== undefined) {\n        const results = style[propertyName] as T;\n        if (!reverseOrder) {\n          return results;\n        }\n\n        styles = styles || [];\n        styles.push(results);\n      }\n    }\n\n    return reverseOrder && styles && styles.length > 0 ? styles[styles.length - 1] : defaultValue;\n  }\n\n  static keyframeShape(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): TimelineKeyframeShape {\n    const shape = TimelineStyleUtils.getKeyframeStyle<TimelineKeyframeShape>(keyframe, rowStyle, options, 'shape', TimelineKeyframeShape.Rhomb);\n    return shape;\n  }\n  static keyframeFillColor(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\n    const color = TimelineStyleUtils.getKeyframeStyle<string>(keyframe, rowStyle, options, 'fillColor', 'DarkOrange');\n    return color;\n  }\n  static keyframeSelectedFillColor(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\n    const color = TimelineStyleUtils.getKeyframeStyle<string>(keyframe, rowStyle, options, 'selectedFillColor', 'red');\n    return color;\n  }\n\n  static keyframeStrokeThickness(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): number {\n    return TimelineStyleUtils.getKeyframeStyle<number>(keyframe, rowStyle, options, 'strokeThickness', 0.2, false);\n  }\n\n  static keyframeStrokeColor(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\n    return TimelineStyleUtils.getKeyframeStyle<string>(keyframe, rowStyle, options, 'strokeColor', 'Black', false);\n  }\n  static keyframeSelectedStrokeColor(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\n    return TimelineStyleUtils.getKeyframeStyle<string>(keyframe, rowStyle, options, 'selectedStrokeColor', 'Black', false);\n  }\n  /**\n   * Get current row height from styling\n   */\n  static getRowHeight(rowStyle: TimelineRowStyle, options: TimelineOptions): number {\n    return TimelineStyleUtils.getRowStyle<number>(rowStyle, options, 'height', 24);\n  }\n  static rowGroupHeight(rowStyle: TimelineRowStyle, options: TimelineOptions): number | string {\n    return TimelineStyleUtils.getRowStyle<number | string>(rowStyle, options, 'groupHeight', 'auto');\n  }\n  static groupFillColor(rowStyle: TimelineRowStyle, options: TimelineOptions): string | null {\n    return TimelineStyleUtils.getRowStyle<string>(rowStyle, options, 'groupFillColor');\n  }\n  static getRowMarginBottom(rowStyle: TimelineRowStyle, options: TimelineOptions): number {\n    return TimelineStyleUtils.getRowStyle<number>(rowStyle, options, 'marginBottom', 0);\n  }\n  static getRowFillColor(rowStyle: TimelineRowStyle, options: TimelineOptions): string {\n    return TimelineStyleUtils.getRowStyle<string>(rowStyle, options, 'fillColor', '#252526');\n  }\n  static headerHeight(options: TimelineOptions | null): number {\n    return options ? options.headerHeight : 0 || 30;\n  }\n  static keyframeDraggable(keyframe: TimelineKeyframeStyle | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null, defaultValue = true): boolean {\n    return TimelineStyleUtils.getKeyframeStyle<boolean>(keyframe, rowStyle, options, 'draggable', defaultValue, false);\n  }\n\n  static groupDraggable(rowStyle: TimelineRowStyle, options: TimelineOptions, defaultValue = true): boolean {\n    return TimelineStyleUtils.getRowStyle<boolean>(rowStyle, options, 'groupDraggable', defaultValue, false);\n  }\n}\n","import { TimelineRanged } from '../timelineRanged';\n\nconst denominators = [1, 2, 5, 10];\nexport class TimelineUtils {\n  static drawLine(ctx: CanvasRenderingContext2D, x1: number, y1: number, x2: number, y2: number): void {\n    ctx.moveTo(x1, y1);\n    ctx.lineTo(x2, y2);\n  }\n  /**\n   * Check is valid number.\n   */\n  static isNumber(val?: number): boolean {\n    if (typeof val === 'number' && !isNaN(val) && Number.isFinite(val)) {\n      return true;\n    }\n\n    return false;\n  }\n  static deleteElement<T>(array: Array<T>, element: T): Array<T> {\n    const index: number = array.indexOf(element);\n    if (index !== -1) {\n      return array.splice(index, 1);\n    }\n    return array;\n  }\n\n  /**\n   * Check rectangle overlap.\n   */\n  static isOverlap(x: number, y: number, rectangle: DOMRect): boolean {\n    if (!rectangle) {\n      return false;\n    }\n\n    if (rectangle.x <= x && rectangle.x + rectangle.width >= x && rectangle.y <= y && rectangle.y + rectangle.height >= y) {\n      return true;\n    }\n\n    return false;\n  }\n  /**\n   * Find beautiful step for the header line gauge.\n   */\n  static findGoodStep(originalStep: number, divisionCheck = 0): number {\n    if (originalStep <= 0 || isNaN(originalStep) || !Number.isFinite(originalStep)) {\n      return originalStep;\n    }\n    let step = originalStep;\n    let lastDistance = null;\n    const pow = TimelineUtils.getPowArgument(originalStep);\n    for (let i = 0; i < denominators.length; i++) {\n      const denominator = denominators[i];\n      const calculatedStep = denominator * Math.pow(10, pow);\n      if (divisionCheck && divisionCheck % calculatedStep != 0) {\n        continue;\n      }\n      const distance = TimelineUtils.getDistance(originalStep, calculatedStep);\n\n      if (distance == 0 || (distance <= 0.1 && pow > 0)) {\n        lastDistance = distance;\n        step = calculatedStep;\n        break;\n      } else if (!lastDistance || lastDistance > distance) {\n        lastDistance = distance;\n        step = calculatedStep;\n      }\n    }\n\n    return step;\n  }\n  /**\n   * Keep value in min, max bounds.\n   */\n  static keepInBounds(value: number, min: number | undefined = null, max: number | undefined = null): number {\n    if (TimelineUtils.isNumber(value)) {\n      if (TimelineUtils.isNumber(min)) {\n        value = Math.max(value, min);\n      }\n      if (TimelineUtils.isNumber(max)) {\n        value = Math.min(value, max);\n      }\n    }\n\n    return value;\n  }\n  static setMinMax(to: TimelineRanged, from: TimelineRanged, shrink = false): TimelineRanged {\n    if (!from || !to) {\n      return to;\n    }\n    const fromMin = Math.min(from.getMin ? from.getMin() : from.min, from.min);\n    const toMin = Math.min(to.getMin ? to.getMin() : to.min, to.min);\n    const isFromMinNumber = TimelineUtils.isNumber(fromMin);\n    const isToMinNumber = TimelineUtils.isNumber(toMin);\n    // get absolute min and max bounds:\n    if (isFromMinNumber && isToMinNumber) {\n      to.min = shrink ? Math.min(fromMin, toMin) : Math.max(fromMin, toMin);\n    } else if (isFromMinNumber) {\n      to.min = fromMin;\n    }\n\n    const fromMax = Math.min(from.getMax ? from.getMax() : from.max, from.max);\n    const toMax = Math.min(to.getMax ? to.getMax() : to.max, to.max);\n    const isFromMaxNumber = TimelineUtils.isNumber(fromMax);\n    const isToMaxNumber = TimelineUtils.isNumber(toMax);\n    if (isFromMaxNumber && isToMaxNumber) {\n      to.max = shrink ? Math.max(fromMax, toMax) : Math.min(fromMax, toMax);\n    } else if (isFromMaxNumber) {\n      to.max = fromMax;\n    }\n\n    return to;\n  }\n  static isRectOverlap(rect: DOMRect, rect2: DOMRect): boolean {\n    if (!rect || !rect2) {\n      console.log('Rectangles cannot be empty');\n      return false;\n    }\n\n    // If one rectangle is on left side of other\n    if (rect.x > rect2.x + rect2.width || rect2.x > rect.x + rect.width) {\n      return true;\n    }\n\n    // If one rectangle is above other\n    if (rect.y < rect2.y + rect2.height || rect2.y < rect.y + rect.height) {\n      return true;\n    }\n    return false;\n  }\n\n  static getDistance(x1: number, y1: number, x2?: number, y2?: number): number {\n    if (x2 != undefined && y2 != undefined) {\n      return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n    } else {\n      return Math.abs(x1 - y1);\n    }\n  }\n  static sign(p: number): number {\n    return p >= 0 ? 1 : -1;\n  }\n\n  static clearBrowserSelection(): void {\n    if (!window) {\n      return;\n    }\n    if (window.getSelection) {\n      window.getSelection().removeAllRanges();\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const doc: any = window.document;\n      if (doc.selection) {\n        doc.selection.empty();\n      }\n    }\n  }\n  static getPowArgument(toCheck: number): number {\n    if (!toCheck || toCheck === 0 || !isFinite(toCheck)) {\n      return 1;\n    }\n    // some optimization for numbers:\n    if (toCheck >= 10 && toCheck < 100) {\n      return 1;\n    } else if (toCheck >= 100 && toCheck < 1000) {\n      return 2;\n    } else if (toCheck >= 1000 && toCheck < 10000) {\n      return 3;\n    }\n\n    toCheck = Math.abs(toCheck);\n    let category = 0;\n    const s = this.sign(toCheck);\n    if (toCheck > 1) {\n      while (toCheck >= 1) {\n        toCheck = Math.floor(toCheck / 10.0);\n        category++;\n      }\n\n      return s * category - 1;\n    } else if (toCheck > 0.0) {\n      // Get number of zeros before the number.\n      const zerosCount = Math.floor(Math.log(toCheck) / Math.log(10) + 1) - 1;\n      return zerosCount;\n    } else {\n      return 1;\n    }\n  }\n}\n","export class TimelineBaseEvent {\n  private _prevented = false;\n  /**\n   * Prevent default click logic.\n   */\n  preventDefault(): void {\n    this._prevented = true;\n  }\n\n  isPrevented(): boolean {\n    return this._prevented;\n  }\n}\n","import { TimelineBaseEvent } from './timelineBaseEvent';\nimport { TimelineElement } from '../timelineElement';\nimport { TimelineEventSource } from '../../enums/timelineEventSource';\n\nexport class TimelineKeyframeChangedEvent extends TimelineBaseEvent {\n  /**\n   * Value to be used.\n   */\n  val: number;\n  /**\n   * Previous value.\n   */\n  prevVal: number;\n  /**\n   * Target element\n   */\n  target: TimelineElement;\n  /**\n   * Event source.\n   */\n  source: TimelineEventSource;\n}\n","export enum TimelineEventSource {\n  User = 'user',\n  Programmatically = 'programmatically',\n  SetTimeMethod = 'setTimeMethod',\n}\n","import { TimelineBaseEvent } from './timelineBaseEvent';\nimport { TimelineEventSource } from '../../enums/timelineEventSource';\n\nexport class TimelineTimeChangedEvent extends TimelineBaseEvent {\n  /**\n   * new value to be set.\n   */\n  val = 0;\n  /**\n   * previous value.\n   */\n  prevVal = 0;\n  source: TimelineEventSource = TimelineEventSource.User;\n}\n","import { TimelineKeyframe } from '../../timelineKeyframe';\nimport { TimelineBaseEvent } from './timelineBaseEvent';\n\nexport class TimelineSelectedEvent extends TimelineBaseEvent {\n  selected: Array<TimelineKeyframe> = [];\n  changed: Array<TimelineKeyframe> = [];\n}\n","import { TimelineElement } from '../timelineElement';\nimport { TimelineBaseEvent } from './timelineBaseEvent';\nimport { TimelineValues } from '../timelineValues';\n\nexport class TimelineClickEvent extends TimelineBaseEvent implements TimelineValues {\n  args: MouseEvent;\n  /**\n   * Clicked screen position.\n   */\n  pos: DOMPoint;\n\n  /**\n   * Elements list under the click\n   */\n  elements: Array<TimelineElement>;\n  /**\n   * Target element\n   */\n  target: TimelineElement;\n  /**\n   * Value to be used.\n   */\n  val: number;\n  /**\n   * Snapped value.\n   */\n  snapVal: number;\n  /**\n   * Unsnapped original value.\n   */\n  originalVal: number;\n}\n","import { TimelineValues } from '../timelineValues';\nimport { TimelineBaseEvent } from './timelineBaseEvent';\nimport { TimelineElementDragState } from '../timelineElementDragState';\n\nexport class TimelineDragEvent extends TimelineBaseEvent implements TimelineValues {\n  args: MouseEvent;\n  /**\n   * Clicked screen position.\n   */\n  pos: DOMPoint;\n\n  /**\n   * Elements to be dragged as a group.\n   */\n  elements: Array<TimelineElementDragState>;\n  /**\n   * Target element\n   */\n  target: TimelineElementDragState;\n  /**\n   * Value to be used.\n   */\n  val: number;\n\n  /**\n   * prev value.\n   */\n  prevVal: number;\n\n  /**\n   * Snapped value.\n   */\n  snapVal: number;\n  /**\n   * Unsnapped original value.\n   */\n  originalVal: number;\n}\n","export enum TimelineInteractionMode {\n  /**\n   * Keyframe selection tool selecting single or group of keyframes.\n   */\n  Selection = 'selection',\n  /**\n   * Pan tool with the possibility to select keyframes.\n   */\n  Pan = 'pan',\n  /**\n   * Allow only pan without any keyframes interaction.\n   * Timeline still can be moved and controlled by option 'timelineInteractive'.\n   */\n  NonInteractivePan = 'nonInteractivePan',\n  /**\n   * Zoom tool.\n   */\n  Zoom = 'zoom',\n\n  /**\n   * No iteraction, except moving a timeline.\n   * Timeline still can be moved and controlled by option 'timelineInteractive'.\n   */\n  None = 'none',\n}\n","export enum TimelineElementType {\n  /**\n   * Timeline\n   */\n  Timeline = 'timeline',\n  /**\n   * Keyframes\n   */\n  Keyframe = 'keyframe',\n  /**\n   * Keyframes group\n   */\n  Group = 'group',\n  /**\n   * Row\n   */\n  Row = 'row',\n}\n","export enum TimelineCursorType {\n  Alias = 'alias',\n  AllScroll = 'all-scroll',\n  Auto = 'auto',\n  Cell = 'cell',\n  ContextMenu = 'context-menu',\n  ColResize = 'col-resize',\n  Copy = 'copy',\n  Crosshair = 'crosshair',\n  Default = 'default',\n  EResize = 'e-resize',\n  EWResize = 'ew-resize',\n  Grab = 'grab',\n  Grabbing = 'grabbing',\n  Help = 'help',\n  Move = 'move',\n  NResize = 'n-resize',\n  NEResize = 'ne-resize',\n  NESWResize = 'nesw-resize',\n  NSResize = 'ns-resize',\n  NWResize = 'nw-resize',\n  NWSEResize = 'nwse-resize',\n  NoDrop = 'no-drop',\n  None = 'none',\n  NotAllowed = 'not-allowed',\n  Pointer = 'pointer',\n  Progress = 'progress',\n  RowResize = 'row-resize',\n  SResize = 's-resize',\n  SEResize = 'se-resize',\n  SWResize = 'sw-resize',\n  Text = 'text',\n  WResize = 'w-resize',\n  Wait = 'wait',\n  ZoomIn = 'zoom-in',\n  ZoomOut = 'zoom-out',\n}\n","export enum TimelineCapShape {\n  None = 'none',\n  Triangle = 'triangle',\n  Rect = 'rect',\n}\n","/**\n * Timeline selection mode.\n */\nexport enum TimelineSelectionMode {\n  /**\n   * Select new items. deselect changed.\n   */\n  Normal = 'normal',\n  /**\n   * Append current selection.\n   */\n  Append = 'append',\n  /**\n   * Revert selection of a specified nodes.\n   */\n  Revert = 'revert',\n}\n","export enum TimelineEvents {\n  Selected = 'selected',\n  TimeChanged = 'timechanged',\n  KeyframeChanged = 'keyframeChanged',\n  DragStarted = 'dragStarted',\n  Drag = 'drag',\n  DragFinished = 'dragFinished',\n  Scroll = 'scroll',\n  ScrollFinished = 'scrollFinished',\n  DoubleClick = 'doubleClick',\n  MouseDown = 'mouseDown',\n}\n","import { TimelineConsts } from './timelineConsts';\nimport { TimelineCapShape } from '../enums/timelineCapShape';\nimport { TimelineStyle } from './styles/timelineStyle';\nimport { TimelineOptions } from './timelineOptions';\nimport { TimelineKeyframeShape } from '../enums/timelineKeyframeShape';\nimport { TimelineKeyframeStyle } from './styles/timelineKeyframeStyle';\nimport { TimelineRowStyle } from './styles/timelineRowStyle';\n\nexport const defaultTimelineStyle = {\n  width: 2,\n  marginTop: 15,\n  capWidth: 4,\n  capHeight: 10,\n  /**\n   * Draw timeline rectangular cap.\n   */\n  capType: TimelineCapShape.Rect,\n  strokeColor: 'DarkOrange',\n  fillColor: 'DarkOrange',\n} as TimelineStyle;\n\nexport const defaultTimelineKeyframeStyle = {\n  /**\n   * keyframe fill color.\n   */\n  fillColor: 'DarkOrange',\n  shape: TimelineKeyframeShape.Rhomb,\n  /**\n   * Selected keyframe fill color.\n   */\n  selectedFillColor: 'red',\n  strokeColor: 'black',\n  selectedStrokeColor: 'black',\n  strokeThickness: 0.2,\n  draggable: true,\n} as TimelineKeyframeStyle;\n\nexport const defaultTimelineRowStyle = {\n  /**\n   * Row height in pixels.\n   */\n  height: 24,\n  marginBottom: 2,\n  fillColor: '#252526',\n  /**\n   * Keyframes group color\n   */\n  groupFillColor: '#094771',\n  groupHeight: 'auto',\n  keyframesStyle: defaultTimelineKeyframeStyle,\n} as TimelineRowStyle;\n\nexport const defaultTimelineOptions = {\n  /**\n   *  Snap all selected keyframes as a bundle during the drag.\n   */\n  snapAllKeyframesOnMove: false,\n\n  /**\n   * Check whether snapping is enabled.\n   */\n  snapEnabled: true,\n\n  timelineStyle: defaultTimelineStyle,\n  /**\n   * approximate step for the timeline in pixels for 1 second\n   */\n  stepPx: 120,\n  /**\n   * Number of units that should fit into one stepPx. (1 second by a default)\n   */\n  stepVal: 1000,\n  stepSmallPx: 30,\n  /**\n   * Snap step in units. from 0 to stepVal\n   */\n  snapStep: 200,\n  /**\n   * additional left margin in pixels to start the line gauge from.\n   */\n  leftMargin: 25,\n  headerFillColor: '#101011',\n  fillColor: '#101011',\n\n  labelsColor: '#D5D5D5',\n  /**\n   * Header gauge tick color.\n   */\n  tickColor: '#D5D5D5',\n  /**\n   * Selection rectangle color.\n   */\n  selectionColor: 'White',\n\n  /**\n   * Default rows style.\n   * Can be overridden by setting style individually for each row.\n   */\n  rowsStyle: defaultTimelineRowStyle,\n  /**\n   * Header height in pixels\n   */\n  headerHeight: 30,\n  font: '11px sans-serif',\n  /**\n   * Default zoom level = 1. where screen pixels are equals to the corresponding stepVal stepPx.\n   */\n  zoom: 1,\n  /**\n   * Default zoom speed.\n   */\n  zoomSpeed: 0.1,\n  /**\n   * Max zoom value.\n   */\n  zoomMin: 0.1,\n  /**\n   * Min zoom value.\n   */\n  zoomMax: 8,\n  /**\n   * Set this to true in a MAC OS environment: The Meta key will be used instead of the Ctrl key.\n   */\n  controlKeyIsMetaKey: false,\n  /**\n   * Access the scroll container via this class for e.g. scroll bar styling.\n   */\n  scrollContainerClass: 'scroll-container',\n  /**\n   * keyframes group is draggable.\n   */\n  groupsDraggable: true,\n  /**\n   * keyframes group is draggable.\n   */\n  keyframesDraggable: true,\n  /**\n   * Timeline can be dragged or position can be changed by user interaction. Default: true\n   */\n  timelineInteractive: true,\n  min: 0,\n  max: Number.MAX_VALUE,\n} as TimelineOptions;\n\nexport const defaultTimelineConsts: TimelineConsts = {\n  /**\n   * Auto pan speed.\n   */\n  autoPanSpeed: 50,\n  /**\n   * scroll speed when mouse drag is used (from 0 to 1)\n   */\n  scrollByDragSpeed: 0.12,\n  /**\n   * Determine whether item was clicked.\n   */\n  clickDetectionMs: 120,\n  /**\n   * Timeout to detect double click.\n   */\n  doubleClickTimeoutMs: 400,\n  /**\n   * Time in ms used to refresh scrollbars when pan is finished.\n   */\n  scrollFinishedTimeoutMs: 500,\n  /**\n   * Auto pan padding\n   */\n  autoPanByScrollPadding: 10,\n  /**\n   * Click threshold\n   */\n  clickThreshold: 3,\n} as TimelineConsts;\n","export enum TimelineScrollSource {\n  DefaultMode = 'none',\n  ZoomMode = 'zoom',\n  ScrollBySelection = 'scrollBySelection',\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n// bundle entry point\n\nimport { TimelineModel } from './timelineModel';\nimport { TimelineRow } from './timelineRow';\nimport { TimelineKeyframe } from './timelineKeyframe';\nimport { TimelineEventsEmitter } from './timelineEventsEmitter';\nimport { TimelineConsts } from './settings/timelineConsts';\nimport { TimelineRanged } from './timelineRanged';\n\n// @public styles\nimport { TimelineOptions } from './settings/timelineOptions';\n\nimport { TimelineStyleUtils } from './utils/timelineStyleUtils';\nimport { TimelineUtils } from './utils/timelineUtils';\nimport { TimelineElement } from './utils/timelineElement';\n\n// @private helper containers.\nimport { TimelineCutBoundsRectResults } from './utils/timelineCutBoundsRectResults';\nimport { TimelineSelectionResults } from './utils/timelineSelectionResults';\nimport { TimelineMouseData } from './utils/timelineMouseData';\nimport { TimelineElementDragState } from './utils/timelineElementDragState';\nimport { TimelineDraggableData } from './utils/timelineDraggableData';\n\n// @private virtual model\nimport { TimelineModelCalcResults } from './utils/timelineModelCalcResults';\nimport { TimelineCalculatedRow } from './utils/timelineCalculatedRow';\nimport { TimelineCalculatedGroup } from './utils/timelineCalculatedGroup';\nimport { TimelineCalculatedKeyframe } from './utils/timelineCalculatedKeyframe';\n\n// @public events\nimport { TimelineKeyframeChangedEvent } from './utils/events/timelineKeyframeChangedEvent';\nimport { TimelineTimeChangedEvent } from './utils/events/timelineTimeChangedEvent';\nimport { TimelineSelectedEvent } from './utils/events/timelineSelectedEvent';\nimport { TimelineScrollEvent } from './utils/events/timelineScrollEvent';\nimport { TimelineClickEvent } from './utils/events/timelineClickEvent';\nimport { TimelineDragEvent } from './utils/events/timelineDragEvent';\n\n// @public enums\nimport { TimelineKeyframeShape } from './enums/timelineKeyframeShape';\nimport { TimelineInteractionMode } from './enums/timelineInteractionMode';\nimport { TimelineElementType } from './enums/timelineElementType';\nimport { TimelineCursorType } from './enums/timelineCursorType';\nimport { TimelineCapShape } from './enums/timelineCapShape';\nimport { TimelineEventSource } from './enums/timelineEventSource';\nimport { TimelineSelectionMode } from './enums/timelineSelectionMode';\nimport { TimelineEvents } from './enums/timelineEvents';\n// @private defaults are exposed:\nimport { defaultTimelineOptions, defaultTimelineConsts } from './settings/defaults';\nimport { TimelineScrollSource } from './enums/timelineScrollSource';\n\nexport class Timeline extends TimelineEventsEmitter {\n  /**\n   * component container.\n   */\n  _container: HTMLElement | null = null;\n  /**\n   * Dynamically generated canvas inside of the container.\n   */\n  _canvas: HTMLCanvasElement | null = null;\n  /**\n   * Dynamically generated scroll container.\n   */\n  _scrollContainer: HTMLElement | null = null;\n  /**\n   * Dynamically generated virtual scroll content.\n   * While canvas has no real size, this element is used to create virtual scroll on the parent element.\n   */\n  _scrollContent: HTMLElement | null = null;\n  /**\n   * Rendering context\n   */\n  _ctx: CanvasRenderingContext2D | null = null;\n  /**\n   * Components settings\n   */\n  _options: TimelineOptions | null = null;\n  /**\n   * Drag start position.\n   */\n  _startPos: TimelineMouseData | null = null;\n  /**\n   * Drag scroll started position.\n   */\n  _scrollStartPos: DOMPoint | null = { x: 0, y: 0 } as DOMPoint;\n  /**\n   * Private. Current mouse position that is used to track values between mouse up/down events.\n   * Can be null, use public methods and properties instead.\n   */\n  _currentPos: TimelineMouseData | null = null;\n\n  /**\n   * Private. Current active mouse area selection rectangle displayed during the mouse up/down drag events.\n   */\n  _selectionRect: DOMRect | null = null;\n  /**\n   * Private. Whether selection rectangle is displayed.\n   */\n  _selectionRectEnabled = false;\n  /**\n   * Private. Information in regard of current active drag state.\n   */\n  _drag: TimelineDraggableData | null = null;\n  _startedDragWithCtrl = false;\n  _startedDragWithShiftKey = false;\n  _scrollProgrammatically = false;\n  _clickTimeout? = 0;\n  _lastClickTime = 0;\n  _lastClickPoint: DOMPoint | null = null;\n  _consts: TimelineConsts = defaultTimelineConsts;\n  /**\n   * Private. whether click is allowed.\n   */\n  _clickAllowed = false;\n  /**\n   * Private. scroll finished timer reference.\n   */\n  _scrollFinishedTimerRef?: number | null = null;\n  /**\n   * Private.Current timeline position.\n   * Please use public get\\set methods to properly change the timeline position.\n   */\n  _val = 0;\n  _pixelRatio = 1;\n  /**\n   * Private. Current zoom level. Please use publicly available properties to set zoom levels.\n   */\n  _currentZoom = 0;\n  /**\n   * Private. Ref for the auto pan scroll interval.\n   */\n  _intervalRef?: number | null = null;\n  _autoPanLastActionDate = 0;\n  _isPanStarted = false;\n  /**\n   * Private.\n   * Component interaction mode. Please use publicly available methods.\n   */\n  _interactionMode = TimelineInteractionMode.Selection;\n  _lastUsedArgs: MouseEvent | TouchEvent | null = null;\n  _model: TimelineModel | null = null;\n  /**\n   * Private.\n   * Indication when scroll are drag or click is started.\n   */\n  _scrollAreaClickOrDragStarted = false;\n  /**\n   * Create Timeline instance\n   * @param options Timeline settings.\n   * @param model Timeline model.\n   */\n  constructor(options: TimelineOptions | null = null, model: TimelineModel | null = null) {\n    super();\n    this._options = this._cloneOptions(defaultTimelineOptions);\n    // Allow to create instance without an error to perform tests.\n    if (options || model) {\n      this.initialize(options, model);\n    } else {\n      console.log('No HTML element is attached to the timeline. initialize method should be called with id.');\n    }\n  }\n\n  /**\n   * Initialize Timeline\n   * @param options Timeline settings.\n   * @param model Timeline model.\n   */\n  public initialize(options: TimelineOptions | null, model: TimelineModel | null): void {\n    this._model = model;\n    if (!options || !options.id) {\n      throw new Error(`Element cannot be empty. Should be string or DOM element.`);\n    }\n\n    this._generateContainers(options.id);\n    this._options = this._cloneOptions(defaultTimelineOptions);\n    if (options) {\n      this._options = this._setOptions(options);\n    }\n    this._subscribeComponentEvents();\n    this.rescale();\n    this.redraw();\n  }\n\n  /**\n   * Generate component html.\n   * @param id container.\n   */\n  _generateContainers(id: string | HTMLElement): void {\n    if (id instanceof HTMLElement) {\n      this._container = id as HTMLElement;\n    } else {\n      this._container = document.getElementById(id);\n    }\n\n    if (!this._container) {\n      throw new Error(`Element cannot be empty. Should be string or DOM element.`);\n    }\n\n    this._scrollContainer = document.createElement('div');\n    this._scrollContent = document.createElement('div');\n    this._canvas = document.createElement('canvas');\n\n    if (!this._canvas || !this._canvas.getContext) {\n      console.log('Cannot initialize canvas context.');\n      return null;\n    }\n\n    this._container.style.position = 'relative';\n    // Generate size container:\n    this._canvas.style.cssText =\n      'image-rendering: -moz-crisp-edges;' +\n      'image-rendering: -webkit-crisp-edges;' +\n      'image-rendering: pixelated;' +\n      'image-rendering: crisp-edges;' +\n      'user-select: none;' +\n      '-webkit-user-select: none;' +\n      '-khtml-user-select: none;' +\n      '-moz-user-select: none;' +\n      '-o-user-select: none;' +\n      'user-select: none;' +\n      'touch-action: none;' +\n      'position: relative;' +\n      '-webkit-user-drag: none;' +\n      '-khtml-user-drag: none;' +\n      '-moz-user-drag: none;' +\n      '-o-user-drag: none;' +\n      'user-drag: none;' +\n      'padding: inherit';\n\n    // Those styles are hardcoded and required for the proper scrolling.\n    this._scrollContainer.style.cssText = 'overflow: scroll;' + 'position: absolute;' + 'width:  100%;' + 'height:  100%;';\n    this._scrollContent.style.width = this._scrollContent.style.height = '100%';\n\n    // add the text node to the created div\n    this._scrollContainer.appendChild(this._scrollContent);\n    this._container.appendChild(this._scrollContainer);\n    const scrollBarWidth = this._scrollContainer.offsetWidth - this._scrollContent.clientWidth;\n    // Calculate current browser scrollbar size and add offset for the canvas\n    this._canvas.style.width = this._canvas.style.height = 'calc(100% -' + (scrollBarWidth || 17) + 'px)';\n\n    this._container.appendChild(this._canvas);\n    this._ctx = this._canvas.getContext('2d');\n  }\n  /**\n   * Subscribe current component on the related events.\n   * Private. Use initialize method instead.\n   */\n  _subscribeComponentEvents(): void {\n    // Allow to call event multiple times, revoke current subscription and subscribe again.\n    this._unsubscribeComponentEvents();\n    if (!this._container || !this._scrollContainer || !this._canvas) {\n      throw Error(`Cannot subscribe on scroll events while one of the containers is null or empty. Please call initialize method first`);\n    }\n    if (this._container) {\n      this._container.addEventListener('wheel', this._handleWheelEvent);\n    }\n    if (this._scrollContainer) {\n      this._scrollContainer.addEventListener('scroll', this._handleScrollEvent);\n      this._scrollContainer.addEventListener('touchstart', this._handleScrollMouseDownEvent);\n      this._scrollContainer.addEventListener('mousedown', this._handleScrollMouseDownEvent);\n    }\n    document.addEventListener('keyup', this._handleKeyUp, false);\n    document.addEventListener('keydown', this._handleKeyDown, false);\n    window.addEventListener('blur', this._handleBlurEvent, false);\n    window.addEventListener('resize', this._handleWindowResizeEvent, false);\n    if (this._canvas) {\n      this._canvas.addEventListener('touchstart', this._handleMouseDownEvent, false);\n      this._canvas.addEventListener('mousedown', this._handleMouseDownEvent, false);\n    }\n    window.addEventListener('mousemove', this._handleMouseMoveEvent, false);\n    window.addEventListener('touchmove', this._handleMouseMoveEvent, false);\n    window.addEventListener('mouseup', this._handleMouseUpEvent, false);\n    window.addEventListener('touchend', this._handleMouseUpEvent, false);\n  }\n\n  /**\n   * Private. Use dispose method instead.\n   */\n  _unsubscribeComponentEvents(): void {\n    this._container.removeEventListener('wheel', this._handleWheelEvent);\n\n    if (this._scrollContainer) {\n      this._scrollContainer.removeEventListener('scroll', this._handleScrollEvent);\n      this._scrollContainer.removeEventListener('touchstart', this._handleScrollMouseDownEvent);\n      this._scrollContainer.removeEventListener('mousedown', this._handleScrollMouseDownEvent);\n    } else {\n      console.warn(`Cannot unsubscribe scroll while it's already empty`);\n    }\n    window.removeEventListener('blur', this._handleBlurEvent);\n    window.removeEventListener('resize', this._handleWindowResizeEvent);\n    document.removeEventListener('keydown', this._handleKeyDown);\n    document.removeEventListener('keyup', this._handleKeyUp);\n    if (this._canvas) {\n      this._canvas.removeEventListener('touchstart', this._handleMouseDownEvent);\n      this._canvas.removeEventListener('mousedown', this._handleMouseDownEvent);\n    } else {\n      console.warn(`Cannot unsubscribe canvas while it's already empty`);\n    }\n    window.removeEventListener('mousemove', this._handleMouseMoveEvent);\n    window.removeEventListener('touchmove', this._handleMouseMoveEvent);\n    window.removeEventListener('mouseup', this._handleMouseUpEvent);\n    window.removeEventListener('touchend', this._handleMouseUpEvent);\n  }\n  /**\n   * Dispose current component: unsubscribe component and user events.\n   */\n  public dispose(): void {\n    // Unsubscribe all user events.\n    this.offAll();\n    // Stop times\n    this._stopAutoPan();\n    this._clearScrollFinishedTimer();\n    this._unsubscribeComponentEvents();\n    this._container = null;\n    this._canvas = null;\n    this._scrollContainer = null;\n    this._scrollContent = null;\n    this._ctx = null;\n    this._cleanUpSelection();\n  }\n  _handleKeyUp = (event: KeyboardEvent): void => {\n    if (this._interactionMode === TimelineInteractionMode.Zoom) {\n      this._setZoomCursor(event);\n    }\n  };\n  _handleKeyDown = (event: KeyboardEvent): void => {\n    if (this._interactionMode === TimelineInteractionMode.Zoom) {\n      this._setZoomCursor(event);\n    }\n  };\n  _setZoomCursor(e: MouseEvent | KeyboardEvent): void {\n    if (this._controlKeyPressed(e)) {\n      this._setCursor(TimelineCursorType.ZoomOut);\n    } else {\n      this._setCursor(TimelineCursorType.ZoomIn);\n    }\n  }\n  _handleBlurEvent = (): void => {\n    this._cleanUpSelection();\n  };\n  _handleWindowResizeEvent = (): void => {\n    // Rescale and redraw\n    this.rescale();\n    this.redraw();\n  };\n\n  _clearScrollFinishedTimer(): void {\n    if (this._scrollFinishedTimerRef) {\n      clearTimeout(this._scrollFinishedTimerRef);\n      this._scrollFinishedTimerRef = null;\n    }\n  }\n  _handleScrollMouseDownEvent = (): void => {\n    this._scrollAreaClickOrDragStarted = true;\n  };\n  _handleScrollEvent = (args: MouseEvent): void => {\n    const scrollProgrammatically = this._scrollProgrammatically;\n    if (this._scrollProgrammatically) {\n      this._scrollProgrammatically = false;\n    }\n    // Stop previous running timeout.\n    this._clearScrollFinishedTimer();\n    // Set a timeout to run event 'scrolling end'.\n    // Auto scroll is used to repeat scroll when drag element or select items outside of the visible area.\n    this._scrollFinishedTimerRef = window.setTimeout(() => {\n      if (!this._isPanStarted) {\n        this._clearScrollFinishedTimer();\n\n        this.rescale();\n        this.redraw();\n      }\n      this._emitScrollEvent(args, scrollProgrammatically, TimelineEvents.ScrollFinished);\n    }, this._consts.scrollFinishedTimeoutMs);\n\n    this.redraw();\n    this._emitScrollEvent(args, scrollProgrammatically);\n  };\n  _controlKeyPressed(e: MouseEvent | KeyboardEvent | TouchEvent): boolean {\n    if (!this._options || this._options.controlKeyIsMetaKey === undefined) {\n      return e.metaKey || e.ctrlKey;\n    }\n    return this._options.controlKeyIsMetaKey || this._options.controlKeyIsMetaKey ? e.metaKey : e.ctrlKey;\n  }\n  _handleWheelEvent = (event: WheelEvent): void => {\n    if (this._controlKeyPressed(event)) {\n      event.preventDefault();\n      const mousePos = Math.max(0, this._getMousePos(this._canvas, event).x || 0);\n      this._zoom(TimelineUtils.sign(event.deltaY), this._options.zoomSpeed, mousePos);\n    } else {\n      this._scrollContainer.scrollTop += event.deltaY;\n      event.preventDefault();\n    }\n  };\n  _zoom(direction: number, speed: number, x: number): void {\n    if (speed > 0 && speed <= 1) {\n      const deltaSpeed = TimelineUtils.getDistance(this._width() / 2, x) * 0.2;\n      x = x + deltaSpeed;\n      const diff = this._width() / x;\n      const val = this._fromScreen(x);\n      const zoom = direction * this._currentZoom * speed;\n      //this._options.zoom\n      this._currentZoom = this._setZoom(this._currentZoom + zoom);\n      // Get only after zoom is set\n      const zoomCenter = this.valToPx(val);\n      let newScrollLeft = Math.round(zoomCenter - this._width() / diff);\n      if (newScrollLeft <= 0) {\n        newScrollLeft = 0;\n      }\n\n      this._rescaleInternal(newScrollLeft + this._width(), null, TimelineScrollSource.ZoomMode);\n      if (this._scrollContainer.scrollLeft != newScrollLeft) {\n        this.setScrollLeft(newScrollLeft);\n      }\n\n      this.redraw();\n    }\n  }\n  /**\n   * Zoom in\n   * @param speed value from 0 to 1\n   */\n  public zoomIn(speed = this._options.zoomSpeed): void {\n    this._zoom(1, speed, this._scrollContainer.clientWidth / 2);\n  }\n  /**\n   * Zoom out.\n   * @param speed value from 0 to 1\n   */\n  public zoomOut(speed = this._options.zoomSpeed): void {\n    this._zoom(-1, speed, this._scrollContainer.clientWidth / 2);\n  }\n  /**\n   * Set direct zoom value.\n   * @param zoom zoom value to set. percent 0-1 and etc.\n   * @param min min zoom.\n   * @param max max zoom.\n   * @return normalized value.\n   */\n  _setZoom(zoom: number, min: number | undefined = null, max: number | undefined = null): number {\n    min = TimelineUtils.isNumber(min) ? min : this._options ? this._options.zoomMin : null;\n    max = TimelineUtils.isNumber(max) ? max : this._options ? this._options.zoomMax : null;\n    if (TimelineUtils.isNumber(zoom)) {\n      zoom = TimelineUtils.keepInBounds(zoom, min, max);\n      zoom = zoom || 1;\n      this._currentZoom = zoom;\n      return zoom;\n    }\n\n    return zoom;\n  }\n\n  /**\n   * Set direct zoom value.\n   * @public\n   * @param zoom zoom value to set. percent 0-1 and etc.\n   * @return normalized value.\n   */\n  setZoom(zoom: number): number {\n    const prevZoom = this.getZoom();\n    if (prevZoom !== zoom) {\n      const zoomSet = this._setZoom(zoom);\n      if (prevZoom != zoomSet) {\n        this.rescale();\n        this.redraw();\n        return zoomSet;\n      }\n    }\n    return prevZoom;\n  }\n  /**\n   * Get current zoom level.\n   */\n  getZoom(): number {\n    if (TimelineUtils.isNumber(this._currentZoom)) {\n      return this._currentZoom || 1;\n    }\n    return 1;\n  }\n  /**\n   * @param args\n   */\n  _handleMouseDownEvent = (args: MouseEvent): void => {\n    let isDoubleClick = Date.now() - this._lastClickTime < this._consts.doubleClickTimeoutMs;\n    // Prevent drag of the canvas if canvas is selected as text:\n    TimelineUtils.clearBrowserSelection();\n\n    this._startPos = this._trackMousePos(this._canvas, args);\n\n    if (!this._startPos) {\n      return;\n    }\n\n    // Don't allow to perform double click if mouse was moved to far.\n    if (this._lastClickPoint && this._startPos && TimelineUtils.getDistance(this._lastClickPoint.x, this._lastClickPoint.y, this._startPos.x, this._startPos.y) > this._consts.clickThreshold) {\n      isDoubleClick = false;\n    }\n\n    this._lastClickPoint = this._startPos;\n    this._scrollStartPos = {\n      x: this._scrollContainer.scrollLeft,\n      y: this._scrollContainer.scrollTop,\n    } as DOMPoint;\n    this._clickAllowed = true;\n    let onlyElements: TimelineElementType[] | null = null;\n    if (this._interactionMode === TimelineInteractionMode.NonInteractivePan || this._interactionMode === TimelineInteractionMode.None) {\n      // Allow to select only timeline. Timeline position can be disabled/enabled by properties.\n      onlyElements = [TimelineElementType.Timeline];\n    }\n    const elements = this.elementFromPoint(this._startPos, Math.max(2, this._startPos.radius), onlyElements);\n\n    const target = this._filterDraggableElements(elements, this._startPos.val);\n    const event = new TimelineClickEvent();\n    event.pos = this._startPos;\n    event.val = this._startPos.val;\n    event.originalVal = this._startPos.originalVal;\n    event.snapVal = this._startPos.snapVal;\n    event.args = args;\n    // all elements under the click:\n    event.elements = elements;\n    // target element.\n    event.target = target;\n\n    if (isDoubleClick) {\n      super.emit(TimelineEvents.DoubleClick, event);\n      return;\n    }\n\n    super.emit(TimelineEvents.MouseDown, event);\n\n    this._clickTimeout = Date.now();\n    this._lastClickTime = Date.now();\n    if (event.isPrevented()) {\n      // Mouse up will be also prevented\n      this._cleanUpSelection();\n      return;\n    }\n\n    this._currentPos = this._startPos;\n\n    // Select keyframes on mouse down\n    if (target && this._interactionMode !== TimelineInteractionMode.Zoom) {\n      this._drag = {\n        changed: false,\n        target: this._setElementDragState(target, target.val),\n        val: target.val,\n        type: target.type,\n        elements: [],\n      } as TimelineDraggableData;\n\n      if (target.type === TimelineElementType.Keyframe) {\n        this._startedDragWithCtrl = this._controlKeyPressed(args);\n        this._startedDragWithShiftKey = args.shiftKey;\n        // get all related selected keyframes if we are selecting one.\n        if (!target.keyframe.selected && !this._controlKeyPressed(args)) {\n          this._selectInternal(target.keyframe);\n        }\n        // Allow to drag all selected keyframes on a screen\n        this._drag.elements = this.getSelectedElements().map((element) => {\n          return this._setElementDragState(element, element.val);\n        });\n      } else if (target.type === TimelineElementType.Group) {\n        const keyframes = this._drag.target.keyframes;\n\n        if (keyframes && Array.isArray(keyframes)) {\n          this._drag.elements = keyframes.map((keyframe) => {\n            return this._setElementDragState(this._convertToElement(this._drag.target.row, keyframe), keyframe.val);\n          });\n        }\n      } else {\n        this._drag.elements = [this._drag.target];\n      }\n    }\n\n    this.redraw();\n  };\n  _setElementDragState(element: TimelineElement | TimelineElementDragState, val: number): TimelineElementDragState {\n    const state = element as TimelineElementDragState;\n    state.prevVal = state.val;\n    if (state.startedVal === undefined || state.startedVal === null) {\n      state.startedVal = val;\n    }\n    if (state.prevVal === undefined || state.prevVal === null) {\n      state.prevVal = val;\n    }\n    state.val = val;\n    return state;\n  }\n  isLeftButtonClicked(args: MouseEvent | TouchEvent | any): boolean {\n    return !!args && args.buttons == 1;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  _handleMouseMoveEvent = (args: MouseEvent | TouchEvent | any): void => {\n    if (!args) {\n      args = this._lastUsedArgs;\n    } else {\n      this._lastUsedArgs = args;\n    }\n    if (!args) {\n      return;\n    }\n    const isTouch = args.changedTouches && args.changedTouches.length > 0;\n    this._currentPos = this._trackMousePos(this._canvas, args);\n    if (!this._isPanStarted && this._selectionRect && this._clickTimeoutIsOver()) {\n      // TODO: implement selection by rect\n      if (this._interactionMode === TimelineInteractionMode.None || this._interactionMode === TimelineInteractionMode.Zoom || this._interactionMode === TimelineInteractionMode.NonInteractivePan) {\n        this._selectionRectEnabled = false;\n      } else {\n        this._selectionRectEnabled = true;\n      }\n    } else {\n      this._selectionRectEnabled = false;\n    }\n\n    args = args as MouseEvent;\n    const isLeftClicked = this.isLeftButtonClicked(args);\n    if (!isLeftClicked) {\n      this._scrollAreaClickOrDragStarted = false;\n    }\n    // On dragging is started.\n    if (this._startPos) {\n      // On left button is on hold by the user\n      if (isLeftClicked || isTouch) {\n        if (this._drag && !this._startedDragWithCtrl) {\n          const convertedVal = this._currentPos.val;\n          if (this._drag.type === TimelineElementType.Timeline) {\n            this._setTimeInternal(convertedVal, TimelineEventSource.User);\n          } else if ((this._drag.type == TimelineElementType.Keyframe || this._drag.type == TimelineElementType.Group) && this._drag.elements) {\n            const offset = Math.floor(convertedVal - this._drag.val);\n            const movedOffset = this._moveElements(offset, this._drag.elements, TimelineEventSource.User);\n            if (movedOffset !== 0) {\n              if (!this._drag.changed) {\n                this._drag.prevVal = this._drag.val;\n                const eventArgs = this._emitDragStartedEvent();\n                if (eventArgs.isPrevented()) {\n                  // Cleanup drag here, so drag finished will be ignored.\n                  this._drag = null;\n                  this._cleanUpSelection();\n                  return;\n                }\n              }\n\n              this._drag.changed = true;\n              this._drag.val += offset;\n              this._emitDragEvent();\n            }\n          }\n        }\n\n        if ((this._interactionMode === TimelineInteractionMode.Pan || this._interactionMode === TimelineInteractionMode.NonInteractivePan) && !this._drag) {\n          this._isPanStarted = true;\n          this._setCursor(TimelineCursorType.Grabbing);\n          // Track scroll by drag.\n          this._scrollByPan(this._startPos, this._currentPos, this._scrollStartPos);\n        } else {\n          if (this._interactionMode !== TimelineInteractionMode.None) {\n            // Track scroll by mouse or touch out of the area.\n            this._scrollBySelectionOutOfBounds(this._currentPos);\n          }\n        }\n\n        this.redraw();\n      } else {\n        // Fallback. Cancel mouse move when focus was lost and mouse down is still counted.\n        this._cleanUpSelection();\n        this.redraw();\n      }\n    } else if (!isTouch) {\n      // Set mouse over cursors\n      let onlyElements: TimelineElementType[] | null = null;\n      if (this._interactionMode === TimelineInteractionMode.NonInteractivePan || this._interactionMode === TimelineInteractionMode.None) {\n        // Allow to select only timeline. Timeline position can be disabled/enabled by properties.\n        onlyElements = [TimelineElementType.Timeline];\n      }\n\n      const elements = this.elementFromPoint(this._currentPos, Math.max(2, this._currentPos.radius), onlyElements);\n      const target = this._filterDraggableElements(elements, this._currentPos.val);\n      if (this._isPanStarted || this._interactionMode === TimelineInteractionMode.Pan || this._interactionMode === TimelineInteractionMode.NonInteractivePan) {\n        if (isLeftClicked) {\n          this._setCursor(TimelineCursorType.Grabbing);\n        } else {\n          this._setCursor(TimelineCursorType.Grab);\n        }\n      } else {\n        if (this._interactionMode === TimelineInteractionMode.Zoom) {\n          this._setZoomCursor(args);\n          return;\n        } else {\n          this._setCursor(TimelineCursorType.Default);\n        }\n      }\n\n      if (target) {\n        let cursor: TimelineCursorType | null = null;\n        if (target.type === TimelineElementType.Group) {\n          cursor = cursor || TimelineCursorType.EWResize;\n        } else if (target.type == TimelineElementType.Keyframe) {\n          cursor = cursor || TimelineCursorType.Pointer;\n        } else if (target.type == TimelineElementType.Timeline) {\n          cursor = cursor || TimelineCursorType.EWResize;\n        }\n\n        if (cursor) {\n          this._setCursor(cursor);\n        }\n      }\n    }\n\n    if (isTouch) {\n      args.preventDefault();\n    }\n  };\n\n  /**\n   * Move elements\n   * @param offset vector to move elements along.\n   * @param elements Element to move.\n   * @returns real moved value.\n   */\n  _moveElements(offset: number, elements: Array<TimelineElementDragState>, source: TimelineEventSource = TimelineEventSource.Programmatically): number {\n    if (!elements) {\n      return;\n    }\n    let isChanged = false;\n    if (Math.abs(offset) > 0) {\n      // Find drag min and max bounds:\n      let bounds = { min: Number.MIN_SAFE_INTEGER, max: Number.MAX_SAFE_INTEGER } as TimelineRanged;\n      bounds = TimelineUtils.setMinMax(bounds, this._options);\n      elements.forEach((p) => {\n        // find allowed bounds for the draggable items.\n        // find for each row and keyframe separately.\n        const currentBounds = TimelineUtils.setMinMax(TimelineUtils.setMinMax({ min: bounds.min, max: bounds.max }, p.keyframe), p.row);\n        const expectedKeyframeValue = this._options && this._options.snapAllKeyframesOnMove ? this.snapVal(p.keyframe.val) : p.keyframe.val;\n        const newPosition = expectedKeyframeValue + offset;\n        if (TimelineUtils.isNumber(currentBounds.min) && newPosition < currentBounds.min) {\n          // Return to the bounds:\n          offset = offset + TimelineUtils.getDistance(currentBounds.min, newPosition);\n        }\n        if (TimelineUtils.isNumber(currentBounds.max) && newPosition > currentBounds.max) {\n          // Return to the bounds:\n          offset = offset - TimelineUtils.getDistance(currentBounds.max, newPosition);\n        }\n      });\n\n      if (Math.abs(offset) > 0) {\n        // don't allow to move less than zero.\n        elements.forEach((element) => {\n          const prevVal = element.keyframe.val;\n          const toSet = prevVal + offset;\n          const newValue = this._setKeyframePos(element, toSet, source);\n          isChanged = newValue !== prevVal;\n        });\n      }\n\n      if (isChanged) {\n        return offset;\n      }\n    }\n\n    return 0;\n  }\n\n  _handleMouseUpEvent = (args: MouseEvent): void => {\n    this._scrollAreaClickOrDragStarted = false;\n    if (this._startPos) {\n      //window.releaseCapture();\n      const pos = this._trackMousePos(this._canvas, args);\n\n      // Click detection.\n      if (this._clickAllowed || !this._clickTimeoutIsOver() || (this._drag && (this._startedDragWithCtrl || this._startedDragWithShiftKey))) {\n        if (this._options && this._interactionMode === TimelineInteractionMode.Zoom) {\n          const direction = this._controlKeyPressed(args) ? 1 : -1;\n          const mousePos = Math.max(0, this._getMousePos(this._canvas, args).x || 0);\n          this._zoom(direction, this._options.zoomSpeed, mousePos);\n        } else {\n          this._performClick(pos, this._drag);\n        }\n      } else if (!this._drag && this._selectionRect && this._selectionRectEnabled) {\n        if (this._interactionMode === TimelineInteractionMode.Zoom) {\n          if (this._selectionRect.width > 20) {\n            // TODO: implement zoom by screen rect.\n          }\n        } else if (this._interactionMode !== TimelineInteractionMode.None) {\n          const keyframes = this._getKeyframesByRectangle(this._selectionRect);\n          const selectionMode = args.shiftKey ? TimelineSelectionMode.Append : TimelineSelectionMode.Normal;\n          this.select(keyframes, selectionMode);\n        }\n      }\n\n      this._cleanUpSelection();\n      this.redraw();\n    }\n  };\n\n  /**\n   * client height.\n   */\n  _height(): number {\n    if (this._canvas) {\n      return this._canvas.clientHeight;\n    }\n    return 0;\n  }\n\n  /**\n   * Client canvas width;\n   */\n  _width(): number {\n    if (this._canvas) {\n      return this._canvas.clientWidth;\n    }\n    return 0;\n  }\n  /**\n   * Convert virtual calculation results to keyframes\n   */\n  _mapKeyframes(array: Array<TimelineCalculatedKeyframe | TimelineElement>): Array<TimelineKeyframe> {\n    const results: Array<TimelineKeyframe> = [];\n    if (!array) {\n      return results;\n    }\n\n    for (let i = 0; i < array.length; i++) {\n      results.push((array[i] as TimelineCalculatedKeyframe).model || (array[i] as TimelineElement).keyframe);\n    }\n    return results;\n  }\n  /**\n   * Get all keyframes under the screen rectangle.\n   * @param screenRect screen coordinates to get keyframes.\n   */\n  _getKeyframesByRectangle(screenRect: DOMRect): TimelineKeyframe[] {\n    const keyframesModels: Array<TimelineKeyframe> = [];\n    this._forEachKeyframe((calcKeyframe) => {\n      if (TimelineUtils.isOverlap(calcKeyframe.size.x, calcKeyframe.size.y, screenRect)) {\n        keyframesModels.push(calcKeyframe.model);\n      }\n    });\n    return keyframesModels;\n  }\n\n  _performClick(pos: TimelineMouseData, drag: TimelineDraggableData): boolean {\n    let isChanged = false;\n    if (drag && drag.type === TimelineElementType.Keyframe) {\n      let mode = TimelineSelectionMode.Normal;\n      if (this._startedDragWithCtrl && this._controlKeyPressed(pos.args)) {\n        if (this._controlKeyPressed(pos.args)) {\n          mode = TimelineSelectionMode.Revert;\n        }\n      } else if (this._startedDragWithShiftKey && pos.args.shiftKey) {\n        mode = TimelineSelectionMode.Append;\n      }\n      // Reverse selected keyframe selection by a click:\n      isChanged = this._selectInternal(this._drag.target.keyframe, mode).selectionChanged || isChanged;\n\n      if (pos.args.shiftKey && this._options?.timelineInteractive !== false) {\n        // Set current timeline position if it's not a drag or selection rect small or fast click.\n        isChanged = this._setTimeInternal(pos.val, TimelineEventSource.User) || isChanged;\n      }\n    } else {\n      // deselect keyframes if any:\n      isChanged = this._selectInternal(null).selectionChanged || isChanged;\n\n      if (this._options?.timelineInteractive !== false) {\n        // change timeline pos:\n        // Set current timeline position if it's not a drag or selection rect small or fast click.\n        isChanged = this._setTimeInternal(pos.val, TimelineEventSource.User) || isChanged;\n      }\n    }\n\n    return isChanged;\n  }\n  /**\n   * Set keyframe value.\n   * @param keyframe\n   * @param value\n   * @return set value.\n   */\n  _setKeyframePos(element: TimelineElementDragState, value: number, source: TimelineEventSource = TimelineEventSource.Programmatically): number {\n    if (!element || !element.keyframe) {\n      return value;\n    }\n    value = Math.floor(value);\n    if (element.keyframe && element.keyframe.val != value) {\n      element.prevVal = element.val;\n      element.val = value;\n      element.keyframe.val = value;\n      const event = this._emitKeyframeChanged(element, source);\n      if (event.isPrevented()) {\n        element.val = event.prevVal;\n        element.keyframe.val = event.prevVal;\n      }\n\n      return value;\n    }\n\n    return value;\n  }\n\n  /**\n   * @param cursor to set.\n   */\n  _setCursor(cursor: string): void {\n    if (this._canvas.style.cursor != cursor) {\n      this._canvas.style.cursor = cursor;\n    }\n  }\n\n  /**\n   * Set component interaction mode.\n   */\n  public setInteractionMode(mode: TimelineInteractionMode): void {\n    if (this._interactionMode != mode) {\n      this._interactionMode = mode;\n      // Avoid any conflicts with other modes, clean current state.\n      this._cleanUpSelection();\n      this.redraw();\n    }\n  }\n  /**\n   * Get current interaction mode.\n   */\n  public getInteractionMode(): TimelineInteractionMode {\n    return this._interactionMode;\n  }\n  _convertToElement(row: TimelineRow, keyframe: TimelineKeyframe): TimelineElement {\n    const data = {\n      type: TimelineElementType.Keyframe,\n      val: keyframe.val,\n      keyframe: keyframe,\n      row: row,\n    } as TimelineElement;\n    return data;\n  }\n\n  public getSelectedKeyframes(): Array<TimelineKeyframe> {\n    return this._mapKeyframes(this.getSelectedElements());\n  }\n\n  public getSelectedElements(): Array<TimelineElement> {\n    const selected: Array<TimelineElement> = [];\n    this._forEachKeyframe((keyframe): void => {\n      if (keyframe && keyframe.model.selected) {\n        selected.push(this._convertToElement(keyframe.parentRow.model, keyframe.model));\n      }\n      return;\n    });\n\n    return selected;\n  }\n  /**\n   * Get all keyframe models available in the model.\n   */\n  public getAllKeyframes(): TimelineKeyframe[] {\n    const keyframes: TimelineKeyframe[] = [];\n    this._forEachKeyframe((keyframe): void => {\n      keyframes.push(keyframe.model);\n    });\n\n    return keyframes;\n  }\n\n  public selectAllKeyframes(): TimelineSelectionResults {\n    return this.select(this.getAllKeyframes(), TimelineSelectionMode.Normal);\n  }\n  public deselectAll(): TimelineSelectionResults {\n    return this.select(null);\n  }\n\n  private _changeNodeState(state: TimelineSelectionResults, node: TimelineKeyframe, value: boolean): boolean {\n    if (node.selected !== value) {\n      const selectable = typeof node.selectable === 'boolean' ? node.selectable : true;\n      if (!value || (value && selectable)) {\n        node.selected = value;\n        state.changed.push(node);\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  public select(nodes: TimelineKeyframe[] | TimelineKeyframe | null, mode = TimelineSelectionMode.Normal): TimelineSelectionResults {\n    const results = this._selectInternal(nodes, mode);\n    if (results.selectionChanged) {\n      this.redraw();\n    }\n    return results;\n  }\n\n  /**\n   * Select keyframes\n   * @param nodes keyframe or list of the keyframes to be selected.\n   * @param mode selection mode.\n   */\n  public _selectInternal(nodes: TimelineKeyframe[] | TimelineKeyframe | null, mode = TimelineSelectionMode.Normal): TimelineSelectionResults {\n    if (!nodes) {\n      nodes = [];\n    }\n    if (!Array.isArray(nodes)) {\n      nodes = [nodes];\n    }\n\n    const state = {\n      selectionChanged: false,\n      selected: this.getSelectedKeyframes(),\n      changed: [] as Array<any>,\n    } as TimelineSelectionResults;\n    const nodesArray = nodes as TimelineKeyframe[];\n    //const state = this.selectedSubject.getValue();\n    if (nodesArray && mode === TimelineSelectionMode.Append) {\n      nodes.forEach((node) => {\n        const changed = this._changeNodeState(state, node, true);\n        if (changed && node.selected) {\n          state.selected.push(node);\n        }\n      });\n    } else if (nodesArray && mode === TimelineSelectionMode.Revert) {\n      nodes.forEach((node) => {\n        if (state.selected.indexOf(node) >= 0) {\n          this._changeNodeState(state, node, false);\n          TimelineUtils.deleteElement<TimelineKeyframe>(state.selected, node);\n        } else {\n          this._changeNodeState(state, node, true);\n          if (node.selected) {\n            state.selected.push(node);\n          }\n        }\n      });\n    } else if (mode === TimelineSelectionMode.Normal) {\n      const selectedItems: Array<TimelineKeyframe> = [];\n      if (nodes) {\n        nodes.forEach((node) => {\n          this._changeNodeState(state, node, true);\n          if (node.selected) {\n            selectedItems.push(node);\n          }\n        });\n      }\n\n      state.selected.forEach((node) => {\n        const exists = nodesArray.indexOf(node) >= 0;\n        // Deselect\n        if (!exists) {\n          this._changeNodeState(state, node, false);\n        }\n      });\n\n      if (state.changed.length > 0) {\n        if (selectedItems) {\n          state.selected = selectedItems;\n        } else {\n          state.selected.length = 0;\n        }\n      }\n    }\n\n    if (state.changed.length > 0) {\n      state.selectionChanged = true;\n      this._emitKeyframesSelected(state);\n    }\n\n    return state;\n  }\n\n  /**\n   * foreach visible keyframe.\n   */\n  _forEachKeyframe(callback: (keyframe: TimelineCalculatedKeyframe, index?: number, newRow?: boolean) => void): void {\n    if (!callback) {\n      return;\n    }\n    if (!this._model) {\n      return;\n    }\n\n    const calculatedModel = this._calculateModel();\n    if (!calculatedModel) {\n      return;\n    }\n\n    calculatedModel.rows.forEach((calcRow) => {\n      if (!calcRow) {\n        return;\n      }\n\n      let nextRow = true;\n      calcRow.keyframes.forEach((keyframe, keyframeIndex) => {\n        if (keyframe) {\n          callback(keyframe, keyframeIndex, nextRow);\n        }\n\n        nextRow = false;\n      });\n    });\n  }\n\n  _trackMousePos(canvas: HTMLCanvasElement, mouseArgs: MouseEvent | TouchEvent): TimelineMouseData {\n    const pos = this._getMousePos(canvas, mouseArgs) as TimelineMouseData;\n    pos.originalVal = this._mousePosToVal(pos.x, false);\n    pos.snapVal = this._mousePosToVal(pos.x, true);\n    pos.val = pos.originalVal;\n    if (this._options && this._options.snapEnabled) {\n      pos.val = pos.snapVal;\n    }\n\n    if (this._startPos) {\n      if (!this._selectionRect) {\n        this._selectionRect = {} as DOMRect;\n      }\n\n      // get the pos with the virtualization:\n      const x = Math.floor(this._startPos.x + (this._scrollStartPos.x - this.getScrollLeft()));\n      const y = Math.floor(this._startPos.y + (this._scrollStartPos.y - this.getScrollTop()));\n      this._selectionRect.x = Math.min(x, pos.x);\n      this._selectionRect.y = Math.min(y, pos.y);\n      this._selectionRect.width = Math.max(x, pos.x) - this._selectionRect.x;\n      this._selectionRect.height = Math.max(y, pos.y) - this._selectionRect.y;\n      // Once mouse was moved outside of the bounds it's not a click anymore\n      if (this._clickAllowed) {\n        this._clickAllowed = this._selectionRect.height <= this._consts.clickThreshold && this._selectionRect.width <= this._consts.clickThreshold;\n      }\n    }\n\n    return pos;\n  }\n\n  /**\n   * Get scroll container client width.\n   */\n  getClientWidth(): number {\n    return this._scrollContainer?.clientWidth || 0;\n  }\n  /**\n   * Get scroll container client height.\n   */\n  getClientHeight(): number {\n    return this._scrollContainer?.clientHeight || 0;\n  }\n  _cleanUpSelection(forcePrevent = false): void {\n    this._emitDragFinishedEvent(forcePrevent);\n    this._startPos = null;\n    this._drag = null;\n    this._scrollAreaClickOrDragStarted = false;\n    this._startedDragWithCtrl = false;\n    this._startedDragWithShiftKey = false;\n    this._selectionRect = null;\n    this._clickTimeout = null;\n    this._scrollStartPos = null;\n    this._isPanStarted = false;\n    this._clickAllowed = false;\n    this._stopAutoPan();\n  }\n\n  /**\n   * Check whether click timeout is over.\n   */\n  _clickTimeoutIsOver(): boolean {\n    // Duration before the selection can be tracked.\n    if (this._clickTimeout && Date.now() - this._clickTimeout > this._consts.clickDetectionMs) {\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Automatically pan. Scroll canvas when selection is made and mouse outside of the bounds.\n   */\n  _startAutoPan(): void {\n    if (this._consts.autoPanSpeed) {\n      if (!this._intervalRef) {\n        // Repeat move calls to\n        this._intervalRef = window.setInterval(() => {\n          this._handleMouseMoveEvent(null);\n        }, this._consts.autoPanSpeed);\n      }\n    }\n  }\n\n  /**\n   * Stop current running auto pan\n   */\n  _stopAutoPan(): void {\n    if (this._intervalRef) {\n      clearInterval(this._intervalRef);\n      this._intervalRef = null;\n    }\n\n    this._autoPanLastActionDate = null;\n  }\n\n  /**\n   * Check whether auto pan should be slowed down a bit.\n   */\n  _checkUpdateSpeedTooFast(): boolean {\n    // Slow down updated a bit.\n    if (this._autoPanLastActionDate && Date.now() - this._autoPanLastActionDate <= 10) {\n      return true;\n    }\n\n    this._autoPanLastActionDate = Date.now();\n    return false;\n  }\n\n  /**\n   * Scroll virtual canvas when pan mode is enabled.\n   */\n  _scrollByPan(start: TimelineMouseData, pos: TimelineMouseData, scrollStartPos: DOMPoint): void {\n    if (!start || !pos) {\n      return;\n    }\n\n    const offsetX = Math.round(start.x - pos.x);\n    const newLeft = scrollStartPos.x + offsetX;\n\n    if (offsetX > 0) {\n      this._rescaleInternal(newLeft + this._width());\n    }\n\n    if (offsetX > 0 && newLeft + this._width() >= this._scrollContainer.scrollWidth - 5) {\n      this.setScrollLeft(this._scrollContainer.scrollWidth);\n    } else {\n      this.setScrollLeft(newLeft);\n    }\n    this._scrollContainer.scrollTop = Math.round(scrollStartPos.y + start.y - pos.y);\n  }\n\n  _scrollBySelectionOutOfBounds(pos: DOMPoint): boolean {\n    const x = pos.x;\n    const y = pos.y;\n    let isChanged = false;\n    let speedX = 0;\n    let speedY = 0;\n    // Small offset to start auto pan earlier.\n    const bounds = this._consts.autoPanByScrollPadding;\n    const isLeft = x <= bounds;\n    const isRight = x >= this._width() - bounds;\n    const isTop = y <= bounds;\n    const isBottom = y >= this._height() - bounds;\n    let newWidth = null;\n    let newHeight = null;\n    if (isLeft || isRight || isTop || isBottom) {\n      // Auto move init\n      this._startAutoPan();\n\n      if (this._checkUpdateSpeedTooFast()) {\n        return false;\n      }\n\n      const scrollSpeedMultiplier = isNaN(this._consts.scrollByDragSpeed) ? 1 : this._consts.scrollByDragSpeed;\n      if (isLeft) {\n        // Get normalized speed.\n        speedX = -TimelineUtils.getDistance(x, bounds) * scrollSpeedMultiplier;\n      } else if (isRight) {\n        // Get normalized speed:\n        speedX = TimelineUtils.getDistance(x, this._width() - bounds) * scrollSpeedMultiplier;\n        newWidth = this.getScrollLeft() + this._width() + speedX;\n      }\n\n      if (isTop) {\n        // Get normalized speed.\n        speedY = (-TimelineUtils.getDistance(x, bounds) * scrollSpeedMultiplier) / 4;\n      } else if (isBottom) {\n        // Get normalized speed:\n        speedY = (TimelineUtils.getDistance(x, this._height() - bounds) * scrollSpeedMultiplier) / 4;\n        newHeight = this._scrollContainer.scrollTop + this._height();\n      }\n    } else {\n      this._stopAutoPan();\n    }\n\n    if (newWidth || newHeight) {\n      this._rescaleInternal(newWidth, newHeight, TimelineScrollSource.ScrollBySelection);\n    }\n\n    if (Math.abs(speedX) > 0) {\n      this.setScrollLeft(this._scrollContainer.scrollLeft + speedX);\n      isChanged = true;\n    }\n\n    if (Math.abs(speedY) > 0) {\n      this.setScrollTop(this._scrollContainer.scrollTop + speedY);\n      isChanged = true;\n    }\n\n    return isChanged;\n  }\n\n  /**\n   * Convert screen pixel to value.\n   */\n  public pxToVal(px: number): number {\n    if (!this._options) {\n      return px;\n    }\n    let min = this._options.min;\n    if (!TimelineUtils.isNumber(min)) {\n      min = 0;\n    }\n    min *= this._currentZoom || 1;\n    const steps = (this._options.stepVal || 0) * this._currentZoom || 1;\n    const val = min + (px / this._options.stepPx) * steps;\n    return val;\n  }\n\n  /**\n   * Convert value to local screen component coordinates.\n   */\n  _toScreenPx(val: number): number {\n    return this.valToPx(val) - this.getScrollLeft() + this._leftMargin();\n  }\n  /**\n   * Convert screen local coordinates to a global value info.\n   */\n  _fromScreen(px: number): number {\n    return this.pxToVal(this.getScrollLeft() + px - this._leftMargin());\n  }\n  /**\n   * Convert area value to global screen pixel coordinates.\n   */\n  public valToPx(val: number): number {\n    if (!this._options) {\n      return val;\n    }\n    let min = this._options.min;\n    if (!TimelineUtils.isNumber(min)) {\n      min = 0;\n    }\n    min *= this._currentZoom || 1;\n    const steps = (this._options.stepVal || 0) * this._currentZoom || 1;\n    return (-min + val) * (this._options.stepPx / steps);\n  }\n\n  /**\n   * Snap a value to a nearest grid point.\n   */\n  public snapVal(val: number): number {\n    // Snap a value if configured.\n    if (this._options && this._options.snapEnabled && this._options.snapStep) {\n      const stops = this._options.snapStep;\n      const step = val / stops;\n      const stepsFit = Math.round(step);\n      const minSteps = Math.abs(this._options.min) / this._options.snapStep;\n      const minOffset = TimelineUtils.sign(this._options.min) * (minSteps - Math.floor(minSteps)) * this._options.snapStep;\n      val = Math.round(minOffset) + Math.round(stepsFit * stops);\n    }\n\n    val = TimelineUtils.keepInBounds(val, this._options.min, this._options.max);\n    return val;\n  }\n\n  _mousePosToVal(x: number, snapEnabled = false): number {\n    const mousePos = Math.min(x, this._width());\n    let convertedVal = this._fromScreen(mousePos);\n    convertedVal = Math.round(convertedVal);\n    if (snapEnabled) {\n      convertedVal = this.snapVal(convertedVal);\n    }\n\n    return convertedVal;\n  }\n\n  /**\n   * Format line gauge text.\n   * Default formatting is HMS\n   * @param ms milliseconds to convert.\n   * @param isSeconds whether seconds are passed.\n   */\n  _formatUnitsText(ms: number, isSeconds = false): string {\n    const sign = TimelineUtils.sign(ms) < 0 ? '-' : '';\n    ms = Math.abs(ms);\n    // 1- Convert to seconds:\n    let seconds = ms / 1000;\n    if (isSeconds) {\n      seconds = ms;\n    }\n\n    const year = Math.floor(seconds / (365 * 86400));\n    seconds = seconds % (365 * 86400);\n\n    const days = Math.floor(seconds / 86400);\n    seconds = seconds % 86400;\n\n    // 2- Extract hours:\n    const hours = Math.floor(seconds / 3600); // 3,600 seconds in 1 hour\n    seconds = seconds % 3600; // seconds remaining after extracting hours\n    // 3- Extract minutes:\n    const minutes = Math.floor(seconds / 60); // 60 seconds in 1 minute\n    // 4- Keep only seconds not extracted to minutes:\n    seconds = seconds % 60;\n    let str = '';\n    if (year) {\n      str += year + ':';\n    }\n\n    if (days) {\n      str += days + ':';\n    }\n\n    if (hours) {\n      str += hours + ':';\n    }\n\n    if (minutes) {\n      str += minutes + ':';\n    }\n\n    if (!isNaN(seconds)) {\n      str += seconds;\n    }\n\n    return sign + str;\n  }\n  /**\n   * Left padding of the timeline.\n   */\n  _leftMargin(): number {\n    if (!this._options) {\n      return 0;\n    }\n    return this._options.leftMargin || 0;\n  }\n  _renderTicks(): void {\n    const rulerActive = !!this._ctx && !!this._options && !!this._ctx.canvas && this._ctx.canvas.clientWidth > 0 && this._ctx.canvas.clientHeight > 0 && this._options.stepPx;\n    if (!rulerActive) {\n      return;\n    }\n    const screenWidth = this._width() - this._leftMargin();\n    let from = this.pxToVal(this.getScrollLeft());\n    let to = this.pxToVal(this.getScrollLeft() + screenWidth);\n    if (isNaN(from) || isNaN(to) || from === to) {\n      return;\n    }\n\n    if (to < from) {\n      const wasToVal = to;\n      to = from;\n      from = wasToVal;\n    }\n\n    const valDistance = TimelineUtils.getDistance(from, to);\n    if (valDistance <= 0) {\n      return;\n    }\n\n    // Find the nearest 'beautiful' step for a gauge.\n    // 'beautiful' step should be dividable by 1/2/5/10!\n    const step = TimelineUtils.findGoodStep(valDistance / (screenWidth / this._options.stepPx));\n    const smallStep = TimelineUtils.findGoodStep(valDistance / (screenWidth / this._options.stepSmallPx));\n\n    // Find beautiful start point:\n    const fromVal = Math.floor(from / step) * step;\n\n    // Find a beautiful end point:\n    const toVal = Math.ceil(to / step) * step + step;\n\n    if (!TimelineUtils.isNumber(step) || step <= 0 || Math.abs(toVal - fromVal) === 0) {\n      return;\n    }\n\n    let lastTextStart = 0;\n    this._ctx.save();\n    const headerHeight = TimelineStyleUtils.headerHeight(this._options);\n    const tickHeight = headerHeight / 2;\n    const smallTickHeight = headerHeight / 1.3;\n    for (let i = fromVal; i <= toVal; i += step) {\n      // local\n      const sharpPos = this._getSharp(this._toScreenPx(i));\n      this._ctx.save();\n      this._ctx.beginPath();\n      this._ctx.setLineDash([4]);\n      this._ctx.lineWidth = 1;\n      this._ctx.strokeStyle = this._options.tickColor;\n      TimelineUtils.drawLine(this._ctx, sharpPos, tickHeight, sharpPos, headerHeight);\n      this._ctx.stroke();\n\n      this._ctx.fillStyle = this._options.labelsColor;\n      if (this._options.font) {\n        this._ctx.font = this._options.font;\n      }\n\n      const text = this._formatUnitsText(i);\n      const textSize = this._ctx.measureText(text);\n\n      const textX = sharpPos - textSize.width / 2;\n      // skip text render if there is no space for it.\n      if (isNaN(lastTextStart) || lastTextStart <= textX) {\n        lastTextStart = textX + textSize.width;\n        this._ctx.fillText(text, textX, 10);\n      }\n\n      this._ctx.restore();\n      if (!TimelineUtils.isNumber(smallStep) || smallStep <= 0) {\n        continue;\n      }\n      // Draw small steps\n      for (let x = i + smallStep; x < i + step; x += smallStep) {\n        // local\n        const nextSharpPos = this._getSharp(this._toScreenPx(x));\n        this._ctx.beginPath();\n        this._ctx.lineWidth = this._pixelRatio;\n        this._ctx.strokeStyle = this._options.tickColor;\n        TimelineUtils.drawLine(this._ctx, nextSharpPos, smallTickHeight, nextSharpPos, headerHeight);\n        this._ctx.stroke();\n      }\n    }\n\n    this._ctx.restore();\n  }\n\n  /**\n   * calculate virtual mode. Determine screen positions for the elements.\n   */\n  _calculateModel(): TimelineModelCalcResults {\n    const toReturn = {\n      rows: [],\n      size: {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0,\n      } as DOMRect,\n      min: null,\n      max: null,\n      keyframes: [] as Array<TimelineCalculatedKeyframe>,\n    } as TimelineModelCalcResults;\n\n    if (!this._model) {\n      return toReturn;\n    }\n    const rows = this._model.rows;\n    if (!rows || !Array.isArray(rows) || rows.length <= 0) {\n      return toReturn;\n    }\n    let rowAbsoluteHeight = TimelineStyleUtils.headerHeight(this._options);\n    rows.forEach((row, index) => {\n      if (!row || row.hidden) {\n        return;\n      }\n\n      // draw with scroll virtualization:\n      const rowHeight = TimelineStyleUtils.getRowHeight(row, this._options);\n      const marginBottom = TimelineStyleUtils.getRowMarginBottom(row, this._options);\n      const currentRowY = rowAbsoluteHeight - (this._scrollContainer ? this._scrollContainer.scrollTop : 0);\n      rowAbsoluteHeight += rowHeight + marginBottom;\n      if (index == 0) {\n        toReturn.size.y = currentRowY;\n      }\n\n      toReturn.size.height = Math.max(rowAbsoluteHeight + rowHeight, toReturn.size.height);\n\n      const calcRow = {\n        size: { x: 0, y: currentRowY, width: this._canvas ? this._width() : 0, height: rowHeight } as DOMRect,\n        marginBottom: marginBottom,\n        model: row,\n        min: null,\n        max: null,\n        groups: [] as Array<TimelineCalculatedGroup>,\n        keyframes: [] as Array<TimelineCalculatedKeyframe>,\n      } as TimelineCalculatedRow;\n      toReturn.rows.push(calcRow);\n      if (!row.keyframes || !row.keyframes.forEach || row.keyframes.length <= 0) {\n        return;\n      }\n\n      // Get min and max ms to draw keyframe rows:\n      if (row && row.keyframes) {\n        row.keyframes.forEach((keyframe) => {\n          if (keyframe && !isNaN(keyframe.val) && !keyframe.hidden) {\n            let currentGroup: TimelineCalculatedGroup = null;\n            for (let i = 0; i < calcRow.groups.length; i++) {\n              const existingGroup = calcRow.groups[i];\n              if (keyframe.group === existingGroup.group) {\n                currentGroup = existingGroup;\n                break;\n              }\n            }\n            if (!currentGroup) {\n              currentGroup = {\n                min: null,\n                max: null,\n                group: keyframe.group,\n                keyframes: [] as Array<TimelineCalculatedKeyframe>,\n              } as TimelineCalculatedGroup;\n\n              calcRow.groups.push(currentGroup);\n            }\n            const keyframeSize = this._getKeyframePosition(keyframe, calcRow);\n            const calcKeyframe = {\n              model: keyframe,\n              parentRow: calcRow,\n              parentGroup: currentGroup,\n              size: keyframeSize,\n            } as TimelineCalculatedKeyframe;\n\n            const min = currentGroup.min == null ? keyframe.val : Math.min(keyframe.val, currentGroup.min);\n            const max = currentGroup.max == null ? keyframe.val : Math.max(keyframe.val, currentGroup.max);\n            if (!isNaN(min)) {\n              currentGroup.min = min;\n            }\n            if (!isNaN(max)) {\n              currentGroup.max = max;\n            }\n            calcRow.keyframes.push(calcKeyframe);\n            currentGroup.keyframes.push(calcKeyframe);\n            toReturn.keyframes.push(calcKeyframe);\n          }\n        });\n      }\n\n      calcRow.groups.forEach((group) => {\n        // Extend row min max bounds by a group bounds:\n        TimelineUtils.setMinMax(calcRow, group, true);\n        // get group screen coords\n        const groupRect = this._getKeyframesGroupSize(row, calcRow.size.y, group.min, group.max);\n        group.size = groupRect;\n      });\n\n      // Extend screen bounds by a current calculation:\n      TimelineUtils.setMinMax(toReturn, calcRow, true);\n    });\n    if (TimelineUtils.isNumber(toReturn.max)) {\n      toReturn.size.width = this.valToPx(toReturn.max);\n    }\n    return toReturn;\n  }\n\n  _renderRows(): void {\n    const data = this._calculateModel();\n    if (data && data.rows) {\n      this._ctx.save();\n      data.rows.forEach((rowCalc) => {\n        if (!rowCalc) {\n          return;\n        }\n\n        this._ctx.fillStyle = TimelineStyleUtils.getRowFillColor(rowCalc.model, this._options);\n        //this._ctx.fillRect(data.areaRect.x, data.areaRect.y, data.areaRect.w, data.areaRect.h);\n        // Note: bounds used instead of the clip while clip is slow!\n        const bounds = this._cutBounds(rowCalc.size);\n        if (bounds) {\n          this._ctx.fillRect(bounds.x, bounds.y, bounds.width, bounds.height);\n        }\n\n        const keyframeLaneColor = TimelineStyleUtils.groupFillColor(rowCalc.model, this._options);\n        if (!rowCalc.groups) {\n          return;\n        }\n        rowCalc.groups.forEach((group) => {\n          // get the bounds on a canvas\n          const rectBounds = this._cutBounds(group.size);\n          if (rectBounds) {\n            this._ctx.fillStyle = keyframeLaneColor;\n            this._ctx.fillRect(rectBounds.x, rectBounds.y, rectBounds.width, rectBounds.height);\n          }\n        });\n      });\n\n      this._ctx.restore();\n    }\n  }\n\n  /**\n   * Method is used for the optimization.\n   * Only visible part should be rendered.\n   */\n  _cutBounds(rect: DOMRect): TimelineCutBoundsRectResults {\n    if (!rect) {\n      return null;\n    }\n    // default bounds: minX, maxX, minY, maxY\n    const minX = 0,\n      maxX = this._width(),\n      minY = TimelineStyleUtils.headerHeight(this._options),\n      maxY = this._width();\n\n    if (\n      TimelineUtils.isRectOverlap(rect, {\n        x: minX,\n        y: minY,\n        width: TimelineUtils.getDistance(minX, maxX),\n        height: TimelineUtils.getDistance(minY, maxY),\n      } as DOMRect)\n    ) {\n      const y = Math.max(rect.y, minY);\n      const x = Math.max(rect.x, minX);\n      const offsetW = rect.x - x;\n      const offsetH = rect.y - y;\n\n      return {\n        height: rect.height + offsetH,\n        width: rect.width + offsetW,\n        x: x,\n        y: y,\n        overlapY: Math.abs(offsetH) > 0,\n        overlapX: Math.abs(offsetW) > 0,\n      } as TimelineCutBoundsRectResults;\n    }\n    return null;\n  }\n\n  /**\n   * get keyframe group screen rect coordinates.\n   * @param row\n   * @param rowY row screen coords y position\n   */\n  _getKeyframesGroupSize(row: TimelineRow, rowY: number, minValue: number, maxValue: number): DOMRect {\n    let groupHeight: number | string = TimelineStyleUtils.rowGroupHeight(row, this._options);\n\n    const height = TimelineStyleUtils.getRowHeight(row, this._options);\n    if ((!groupHeight && groupHeight !== 0) || isNaN(groupHeight as number) || groupHeight == 'auto') {\n      groupHeight = Math.floor(height * 0.7);\n    }\n\n    if (groupHeight > height) {\n      groupHeight = height;\n    }\n\n    const margin = height - (groupHeight as number);\n    // draw keyframes rows.\n    const xMin = this._toScreenPx(minValue); // local\n    const xMax = this._toScreenPx(maxValue); // local\n\n    return {\n      x: xMin,\n      y: rowY + Math.floor(margin / 2),\n      height: groupHeight,\n      width: TimelineUtils.getDistance(xMin, xMax),\n    } as DOMRect;\n  }\n\n  _getKeyframePosition(keyframe: TimelineKeyframe, rowCalculated: TimelineCalculatedRow): DOMRect | null {\n    if (!keyframe) {\n      console.log('keyframe should be defined.');\n      return null;\n    }\n\n    const val = keyframe.val;\n    if (isNaN(val)) {\n      return null;\n    }\n\n    const rowSize = rowCalculated.size;\n    // get center of the lane:\n    const y = rowSize.y + rowSize.height / 2;\n\n    let height: number | string = TimelineStyleUtils.getKeyframeStyle(keyframe, rowCalculated.model, this._options, 'height', 'auto');\n    let width: number | string = TimelineStyleUtils.getKeyframeStyle(keyframe, rowCalculated.model, this._options, 'width', 'auto');\n\n    if (height == 'auto') {\n      height = rowSize.height / 3;\n    }\n    if (width == 'auto') {\n      width = height;\n    }\n    if (height > 0) {\n      if (!isNaN(val)) {\n        return {\n          x: Math.floor(this._toScreenPx(val)), // local\n          y: Math.floor(y),\n          height: height,\n          width: width,\n        } as DOMRect;\n      }\n    }\n\n    return null;\n  }\n\n  _renderKeyframes(): void {\n    this._forEachKeyframe((calcKeyframe): boolean => {\n      const row = calcKeyframe.parentRow.model;\n      const pos = calcKeyframe.size;\n      const keyframe = calcKeyframe.model;\n      if (pos) {\n        let x = this._getSharp(pos.x);\n        let y = pos.y;\n        const bounds = this._cutBounds({\n          x: x - pos.width / 2,\n          y: y - pos.height / 2,\n          width: pos.width,\n          height: pos.height,\n        } as DOMRect);\n        if (!bounds) {\n          return;\n        }\n\n        this._ctx.save();\n\n        // Performance FIX: use clip only  when we are in the collision! Clip is slow!\n        // Other keyframes should be hidden by bounds check.\n        if (bounds && bounds.overlapY) {\n          this._ctx.beginPath();\n          this._ctx.rect(0, TimelineStyleUtils.headerHeight(this._options), this._width(), this._width());\n          this._ctx.clip();\n        }\n\n        const shape = TimelineStyleUtils.keyframeShape(keyframe, row, this._options);\n        if (shape === TimelineKeyframeShape.None) {\n          return;\n        }\n\n        const keyframeColor = keyframe.selected ? TimelineStyleUtils.keyframeSelectedFillColor(keyframe, row, this._options) : TimelineStyleUtils.keyframeFillColor(keyframe, row, this._options);\n        const border = TimelineStyleUtils.keyframeStrokeThickness(keyframe, row, this._options);\n        let strokeColor = '';\n        if (border > 0) {\n          if (keyframe.selected) {\n            strokeColor = TimelineStyleUtils.keyframeSelectedStrokeColor(keyframe, row, this._options);\n          } else {\n            strokeColor = TimelineStyleUtils.keyframeStrokeColor(keyframe, row, this._options);\n          }\n        }\n\n        if (shape == TimelineKeyframeShape.Rhomb) {\n          this._ctx.beginPath();\n          this._ctx.translate(x, y);\n          this._ctx.rotate((45 * Math.PI) / 180);\n          if (border > 0 && strokeColor) {\n            this._ctx.fillStyle = strokeColor;\n            this._ctx.rect(-pos.width / 2, -pos.height / 2, pos.width, pos.height);\n            this._ctx.fill();\n          }\n\n          this._ctx.fillStyle = keyframeColor;\n          // draw main keyframe data with offset.\n          this._ctx.translate(border, border);\n          this._ctx.rect(-pos.width / 2, -pos.height / 2, pos.width - border * 2, pos.height - border * 2);\n          this._ctx.fill();\n        } else if (shape == TimelineKeyframeShape.Circle) {\n          this._ctx.beginPath();\n          if (border > 0 && strokeColor) {\n            this._ctx.fillStyle = strokeColor;\n            this._ctx.arc(x, y, pos.height, 0, 2 * Math.PI);\n          }\n          this._ctx.fillStyle = keyframeColor;\n          this._ctx.arc(x, y, pos.height - border, 0, 2 * Math.PI);\n          this._ctx.fill();\n        } else if (shape == TimelineKeyframeShape.Rect) {\n          this._ctx.beginPath();\n          y = y - pos.height / 2;\n          x = x - pos.width / 2;\n          if (border > 0 && strokeColor) {\n            this._ctx.fillStyle = strokeColor;\n            this._ctx.rect(x, y, pos.width, pos.height);\n            this._ctx.fill();\n          }\n\n          this._ctx.fillStyle = keyframeColor;\n          this._ctx.rect(x + border, y + border, pos.width - border, pos.height - border);\n          this._ctx.fill();\n        }\n\n        this._ctx.restore();\n      }\n    });\n  }\n\n  _renderSelectionRect(): void {\n    if (this._drag) {\n      return;\n    }\n\n    this._ctx.save();\n    const thickness = 1;\n    if (this._selectionRect && this._selectionRectEnabled) {\n      this._ctx.setLineDash([4]);\n      this._ctx.lineWidth = this._pixelRatio;\n      this._ctx.strokeStyle = this._options.selectionColor;\n      this._ctx.strokeRect(\n        this._getSharp(this._selectionRect.x, thickness),\n        this._getSharp(this._selectionRect.y, thickness),\n        Math.floor(this._selectionRect.width),\n        Math.floor(this._selectionRect.height),\n      );\n    }\n    this._ctx.restore();\n  }\n\n  _renderBackground(): void {\n    if (this._options.fillColor) {\n      this._ctx.save();\n      this._ctx.beginPath();\n      this._ctx.rect(0, 0, this._width(), this._height());\n      this._ctx.fillStyle = this._options.fillColor;\n      this._ctx.fill();\n      this._ctx.restore();\n    } else {\n      // Clear if bg not set.\n      this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\n    }\n  }\n\n  _renderTimeline(): void {\n    if (!this._ctx || !this._options || !this._options.timelineStyle) {\n      return;\n    }\n    const style = this._options.timelineStyle;\n    this._ctx.save();\n    const thickness = style.width || 1;\n    this._ctx.lineWidth = thickness * this._pixelRatio;\n    const timeLinePos = this._getSharp(this._toScreenPx(this._val), thickness);\n    this._ctx.strokeStyle = style.strokeColor;\n    this._ctx.fillStyle = style.fillColor;\n    const y = style.marginTop;\n    this._ctx.beginPath();\n    TimelineUtils.drawLine(this._ctx, timeLinePos, y, timeLinePos, this._height());\n    this._ctx.stroke();\n\n    if (style.capHeight && style.capWidth) {\n      const rectSize = style.capWidth;\n      const capHeight = style.capHeight;\n      if (style.capType === TimelineCapShape.Triangle) {\n        this._ctx.beginPath();\n        this._ctx.moveTo(timeLinePos - rectSize / 2, y);\n        this._ctx.lineTo(timeLinePos + rectSize / 2, y);\n        this._ctx.lineTo(timeLinePos, capHeight);\n        this._ctx.closePath();\n        this._ctx.stroke();\n      } else if (style.capType === TimelineCapShape.Rect) {\n        this._ctx.fillRect(timeLinePos - rectSize / 2, y, rectSize, capHeight);\n        this._ctx.fill();\n      }\n    }\n\n    this._ctx.restore();\n  }\n\n  _renderHeaderBackground(): void {\n    if (!this._ctx || !this._options) {\n      return;\n    }\n    if (TimelineStyleUtils.headerHeight(this._options)) {\n      this._ctx.save();\n      // draw ticks background\n      this._ctx.lineWidth = this._pixelRatio;\n      if (this._options.headerFillColor) {\n        // draw ticks background\n        this._ctx.lineWidth = this._pixelRatio;\n        // draw header background\n        this._ctx.fillStyle = this._options.headerFillColor;\n        this._ctx.fillRect(0, 0, this._width(), TimelineStyleUtils.headerHeight(this._options));\n      } else {\n        this._ctx.clearRect(0, 0, this._width(), TimelineStyleUtils.headerHeight(this._options));\n      }\n      this._ctx.restore();\n    }\n  }\n\n  redraw(): void {\n    if (window.requestAnimationFrame) {\n      window.requestAnimationFrame(this._redrawInternal);\n    } else {\n      this._redrawInternal();\n    }\n  }\n\n  /**\n   * perform scroll to max left.\n   */\n  public scrollLeft(): void {\n    if (this._scrollContainer && this._scrollContainer.scrollLeft != this._scrollContainer.scrollWidth) {\n      this.setScrollLeft(this._scrollContainer.scrollWidth);\n    }\n  }\n\n  /**\n   * Redraw parts of the component in the specific order.\n   */\n  _redrawInternal = (): void => {\n    if (!this._ctx) {\n      return;\n    }\n    // Rescale when animation is played out of the bounds.\n    if (this.valToPx(this._val) > this._scrollContainer.scrollWidth) {\n      this.rescale();\n      if (!this._isPanStarted && this._drag && this._drag.type !== TimelineElementType.Timeline) {\n        this.scrollLeft();\n      }\n    }\n\n    this._renderBackground();\n    this._renderRows();\n    // Render after rows\n    this._renderHeaderBackground();\n    this._renderTicks();\n    this._renderKeyframes();\n    this._renderSelectionRect();\n    this._renderTimeline();\n  };\n\n  /**\n   * Get row by y coordinate.\n   * @param posY y screen coordinate.\n   */\n  public getRowByY(posY: number): TimelineRow {\n    const model = this._calculateModel();\n    if (model && model.rows) {\n      for (let i = 0; i < model.rows.length; i++) {\n        const row = model.rows[i].size;\n        if (row && row.y >= posY && posY <= row.y + row.height) {\n          return row;\n        }\n      }\n    }\n\n    return null;\n  }\n  /**\n   * Find sharp pixel position\n   */\n  _getSharp(pos: number, thickness = 1): number {\n    pos = Math.round(pos);\n    if (thickness % 2 == 0) {\n      return pos;\n    }\n\n    return pos + this._pixelRatio / 2;\n  }\n\n  /**\n   * Get current time:\n   */\n  public getTime(): number {\n    return this._val;\n  }\n\n  /**\n   * Set current time internal\n   * @param val value.\n   * @param source event source.\n   */\n  _setTimeInternal(val: number, source: TimelineEventSource = TimelineEventSource.Programmatically): boolean {\n    val = Math.round(val);\n    if (val < this._options.min) {\n      val = this._options.min;\n    }\n\n    if (this._val != val) {\n      const prevVal = this._val;\n      const timelineEvent = new TimelineTimeChangedEvent();\n      timelineEvent.val = val;\n      timelineEvent.prevVal = prevVal;\n      timelineEvent.source = source;\n      this._val = val;\n      this.emit(TimelineEvents.TimeChanged, timelineEvent);\n      if (timelineEvent.isPrevented()) {\n        this._val = prevVal;\n        return false;\n      }\n      return true;\n    }\n\n    return false;\n  }\n  public setTime(val: number): boolean {\n    // don't allow to change time during drag:\n    if (this._drag && this._drag.type === TimelineElementType.Timeline) {\n      return false;\n    }\n\n    const isChanged = this._setTimeInternal(val, TimelineEventSource.SetTimeMethod);\n    if (isChanged) {\n      this.rescale();\n      this.redraw();\n    }\n\n    return isChanged;\n  }\n\n  public getOptions(): TimelineOptions {\n    return this._options;\n  }\n\n  public setScrollLeft(value: number): void {\n    if (this._scrollContainer && this._scrollContainer.scrollLeft !== value) {\n      this._scrollProgrammatically = true;\n      this._scrollContainer.scrollLeft = value;\n    }\n  }\n  public setScrollTop(value: number): void {\n    if (this._scrollContainer && this._scrollContainer.scrollTop !== value) {\n      this._scrollProgrammatically = true;\n      this._scrollContainer.scrollTop = value;\n    }\n  }\n  public getScrollLeft(): number {\n    return this._scrollContainer ? this._scrollContainer.scrollLeft : 0;\n  }\n  public getScrollTop(): number {\n    return this._scrollContainer ? this._scrollContainer.scrollTop : 0;\n  }\n\n  /**\n   * Set options and render the component.\n   * Note: Options will be merged\\appended with the defaults and component will be invalidated/rendered again.\n   */\n  public setOptions(toSet: TimelineOptions): TimelineOptions {\n    this._options = this._setOptions(toSet);\n    this.rescale();\n    this.redraw();\n    // Merged options:\n    return this._options;\n  }\n\n  /**\n   * Private. Apply html container styles from options if any is set.\n   */\n  _applyContainersStyles(): void {\n    if (this._scrollContainer && this._options) {\n      const classList = this._scrollContainer.classList;\n      if (this._options.scrollContainerClass && !classList.contains(this._options.scrollContainerClass)) {\n        classList.add(this._options.scrollContainerClass);\n      }\n      if (this._options.fillColor) {\n        this._scrollContainer.style.background = this._options.fillColor;\n      }\n    }\n  }\n  _setOptions(toSet: TimelineOptions): TimelineOptions {\n    if (!toSet) {\n      return this._options;\n    }\n    this._options = this._mergeOptions(this._options, toSet);\n    // Normalize and validate spans per value.\n    this._options.snapStep = TimelineUtils.keepInBounds(this._options.snapStep, 0, this._options.stepVal || 0);\n    this._currentZoom = this._setZoom(this._options.zoom, this._options.zoomMin, this._options.zoomMax);\n    this._options.min = TimelineUtils.isNumber(this._options.min) ? this._options.min : 0;\n    this._options.max = TimelineUtils.isNumber(this._options.max) ? this._options.max : Number.MAX_VALUE;\n    this._applyContainersStyles();\n    // Prevent current active dragging of the timeline, while it's set that it's not allowed anymore.\n    if (toSet.timelineInteractive === false) {\n      if (this._drag && this._drag.type === TimelineElementType.Timeline) {\n        this._cleanUpSelection();\n      }\n    }\n    return this._options;\n  }\n\n  public getModel(): TimelineModel {\n    return this._model;\n  }\n\n  /**\n   * Set model and redraw application.\n   * @param data\n   */\n  public setModel(data: TimelineModel): void {\n    this._model = data;\n    this.rescale();\n    this.redraw();\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  _getMousePos(canvas: HTMLCanvasElement, e: TouchEvent | MouseEvent | any): TimelineMouseData {\n    let radius = 1;\n    let clientX = 0;\n    let clientY = 0;\n    if (e.changedTouches && e.changedTouches.length > 0) {\n      // TODO: implement better touch support\n      const touch = e.changedTouches[0];\n      clientX = touch.clientX;\n      clientY = touch.clientY;\n      radius = Math.max(radius, touch.radiusX, touch.radiusY);\n    } else {\n      clientX = e.clientX;\n      clientY = e.clientY;\n    }\n\n    const rect = canvas.getBoundingClientRect(), // abs. size of element\n      scaleX = canvas.width / this._pixelRatio / rect.width, // relationship bitmap vs. element for X\n      scaleY = canvas.height / this._pixelRatio / rect.height; // relationship bitmap vs. element for Y\n\n    const x = (clientX - rect.left) * scaleX;\n    const y = (clientY - rect.top) * scaleY;\n    // scale mouse coordinates after they have been adjusted to be relative to element\n    return {\n      x: x,\n      y: y,\n      radius,\n      args: e,\n    } as TimelineMouseData;\n  }\n\n  /**\n   * Apply container div size to the container on changes detected.\n   */\n  _updateCanvasScale(): boolean {\n    if (!this._scrollContainer || !this._container || !this._ctx) {\n      console.log('Component should be initialized first');\n      return;\n    }\n    let changed = false;\n    const width = this._scrollContainer.clientWidth * this._pixelRatio;\n    const height = this._scrollContainer.clientHeight * this._pixelRatio;\n    if (Math.floor(width) != Math.floor(this._ctx.canvas.width)) {\n      this._ctx.canvas.width = width;\n      changed = true;\n    }\n\n    if (Math.floor(height) != Math.floor(this._ctx.canvas.height)) {\n      this._ctx.canvas.height = height;\n      changed = true;\n    }\n\n    if (changed) {\n      this._ctx.setTransform(this._pixelRatio, 0, 0, this._pixelRatio, 0, 0);\n    }\n    return changed;\n  }\n\n  /**\n   * Rescale and update size of the container.\n   */\n  public rescale(): boolean {\n    return this._rescaleInternal();\n  }\n\n  /**\n   * This method is used to draw additional space when after there are no keyframes.\n   * When scrolled we should allow to indefinitely scroll right, so space should be extended to drag keyframes outside of the current size bounds.\n   */\n  _rescaleInternal(newWidth: number | null = null, newHeight: number | null = null, scrollMode = TimelineScrollSource.DefaultMode): boolean {\n    let changed = this._updateCanvasScale();\n    const data = this._calculateModel();\n    if (data && data.size) {\n      const additionalOffset = this._options.stepPx;\n      newWidth = newWidth || 0;\n      // content should be not less than current timeline position + width of the timeline\n      const timelineGlobalPos = this.valToPx(this._val) + this._leftMargin();\n      let timelinePos = 0;\n      const rightPosition = this.getScrollLeft() + this.getClientWidth();\n\n      if (timelineGlobalPos >= rightPosition) {\n        if (scrollMode == TimelineScrollSource.ScrollBySelection) {\n          // When item (timeline, selection rectangle) is just dragged to the right corner.\n          timelinePos = Math.floor(timelineGlobalPos + this._leftMargin());\n        } else {\n          // When timeline is playing and we need to add next screen (when timeline goes out of the bounds.)\n          timelinePos = Math.floor(timelineGlobalPos + this.getClientWidth() + this._leftMargin());\n        }\n      }\n      const keyframeW = data.size.width + this._leftMargin() + additionalOffset;\n\n      newWidth = Math.max(\n        // New expected component width.\n        newWidth,\n        // keyframes max width\n        keyframeW,\n        // not less than current scroll position\n        rightPosition,\n        timelinePos,\n      );\n\n      const minWidthPx = Math.floor(newWidth) + 'px';\n      if (minWidthPx != this._scrollContent.style.minWidth) {\n        this._scrollContent.style.minWidth = minWidthPx;\n        changed = true;\n      }\n\n      newHeight = Math.max(Math.floor(data.size.height + this._height() * 0.2), this._scrollContainer.scrollTop + this._height() - 1, Math.round(newHeight || 0));\n\n      const h = Math.floor(newHeight) + 'px';\n      if (this._scrollContent.style.minHeight != h) {\n        this._scrollContent.style.minHeight = h;\n        return changed;\n      }\n    }\n    return changed;\n  }\n\n  /**\n   * Filter and sort draggable elements by the priority to get first draggable element.\n   * Filtration is done based on the timeline styles and options.\n   * @param elements to filter and sort.\n   * @param val current mouse value to find best match.\n   */\n  _filterDraggableElements(elements: TimelineElement[], val: number | null = null): TimelineElement {\n    // filter and sort: Timeline, individual keyframes, groups (distance).\n    const getPriority = (type: TimelineElementType): number => {\n      if (type === TimelineElementType.Timeline) {\n        return 1;\n      } else if (type === TimelineElementType.Keyframe) {\n        return 2;\n      } else if (type === TimelineElementType.Group) {\n        return 3;\n      }\n      return -1;\n    };\n    const filteredElements = elements.filter((element) => {\n      if (!element) {\n        return false;\n      }\n      if (element.type === TimelineElementType.Keyframe) {\n        if (!TimelineStyleUtils.keyframeDraggable(element.keyframe, element.row, this._options)) {\n          return false;\n        }\n      } else if (element.type === TimelineElementType.Group) {\n        if (!TimelineStyleUtils.groupDraggable(element.row, this._options)) {\n          return false;\n        }\n      } else if (element.type === TimelineElementType.Timeline) {\n        if (this._options?.timelineInteractive === false) {\n          return false;\n        }\n      } else if (element.type === TimelineElementType.Row) {\n        return false;\n      }\n      return true;\n    });\n    const sortDraggable = (a: TimelineElement, b: TimelineElement): number => {\n      let prioA = getPriority(a.type);\n      let prioB = getPriority(b.type);\n      if (prioA === prioB) {\n        if (val === null) {\n          return 0;\n        }\n\n        // Sort by distance\n        prioA = TimelineUtils.getDistance(a.val, val);\n        prioB = TimelineUtils.getDistance(b.val, val);\n        if (prioA === prioB) {\n          return 0;\n        }\n        return prioA < prioB ? 1 : -1;\n      }\n\n      return prioA < prioB ? 1 : -1;\n    };\n    const sorted = filteredElements.sort(sortDraggable);\n    if (sorted.length > 0) {\n      return sorted[sorted.length - 1];\n    }\n\n    return null;\n  }\n\n  /**\n   * get all clickable elements by the given local screen coordinate.\n   */\n  public elementFromPoint(pos: DOMPoint, clickRadius = 2, onlyTypes?: TimelineElementType[] | null): TimelineElement[] {\n    clickRadius = Math.max(clickRadius, 1);\n    const toReturn: TimelineElement[] = [];\n\n    if (!pos) {\n      return toReturn;\n    }\n\n    const headerHeight = TimelineStyleUtils.headerHeight(this._options);\n    // Check whether we can drag timeline.\n    const timeLinePos = this._toScreenPx(this._val);\n    let width = 0;\n    if (this._options && this._options.timelineStyle) {\n      const timelineStyle = this._options.timelineStyle;\n      width = Math.max((timelineStyle.width || 1) * this._pixelRatio, (timelineStyle.capWidth || 0) * this._pixelRatio || 1) + clickRadius;\n    }\n    // Allow to select timeline only by half of a header to allow select by a selector top most keyframes row.\n    if (pos.y <= headerHeight * 0.5 || (pos.x >= timeLinePos - width / 2 && pos.x <= timeLinePos + width / 2)) {\n      toReturn.push({\n        val: this._val,\n        type: TimelineElementType.Timeline,\n      } as TimelineElement);\n    }\n    const snap = this._options.snapEnabled;\n    if (pos.y >= headerHeight && this._options.keyframesDraggable) {\n      this._forEachKeyframe((calcKeyframe, index, isNextRow): void => {\n        // Check keyframes group overlap\n        if (isNextRow) {\n          const rowOverlapped = TimelineUtils.isOverlap(pos.x, pos.y, calcKeyframe.parentRow.size);\n          if (rowOverlapped) {\n            const row = {\n              val: this._mousePosToVal(pos.x, snap),\n              keyframes: calcKeyframe.parentRow.model.keyframes,\n              type: TimelineElementType.Row,\n              row: calcKeyframe.parentRow.model,\n            } as TimelineElement;\n            toReturn.push(row);\n          }\n          if (calcKeyframe.parentRow.groups) {\n            calcKeyframe.parentRow.groups.forEach((group) => {\n              const keyframesGroupOverlapped = TimelineUtils.isOverlap(pos.x, pos.y, group.size);\n              if (keyframesGroupOverlapped) {\n                const keyframesModels = this._mapKeyframes(group.keyframes);\n                const groupElement = {\n                  val: this._mousePosToVal(pos.x, snap),\n                  type: TimelineElementType.Group,\n                  group: group,\n                  row: calcKeyframe.parentRow.model,\n                  keyframes: keyframesModels,\n                } as TimelineElement;\n\n                const snapped = this.snapVal(group.min);\n                // get snapped mouse pos based on a min value.\n                groupElement.val += group.min - snapped;\n                toReturn.push(groupElement);\n              }\n            });\n          }\n        }\n\n        const keyframePos = calcKeyframe.size;\n        if (keyframePos) {\n          const dist = TimelineUtils.getDistance(keyframePos.x, keyframePos.y, pos.x, pos.y);\n          if (dist <= keyframePos.height + clickRadius) {\n            toReturn.push({\n              keyframe: calcKeyframe.model,\n              keyframes: [calcKeyframe.model],\n              val: calcKeyframe.model.val,\n              row: calcKeyframe.parentRow.model,\n              type: TimelineElementType.Keyframe,\n            } as TimelineElement);\n          }\n        }\n      });\n    }\n\n    if (!onlyTypes || onlyTypes.length === 0) {\n      return toReturn;\n    } else {\n      return toReturn.filter((p) => onlyTypes && onlyTypes.includes(p.type));\n    }\n  }\n\n  _cloneOptions(previousOptions: TimelineOptions): TimelineOptions {\n    return JSON.parse(JSON.stringify(previousOptions));\n  }\n  /**\n   * Merge options. New keys will be added.\n   */\n  _mergeOptions(previousOptions: TimelineOptions, newOptions: TimelineOptions): TimelineOptions {\n    newOptions = newOptions || ({} as TimelineOptions);\n    // Apply incoming options to default. (override default)\n    // Deep clone default options:\n    const toArg = this._cloneOptions(previousOptions);\n    // Merge options with the default.\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const mergeOptionsDeep = (to: any, from: any): void => {\n      if (!to || !from) {\n        return;\n      }\n      // eslint-disable-next-line prefer-const\n      for (let key in from) {\n        if (Object.prototype.hasOwnProperty.call(from, key)) {\n          if (from[key] !== undefined) {\n            if (typeof from[key] === 'object') {\n              if (!to[key]) {\n                to[key] = from[key];\n              } else {\n                mergeOptionsDeep(to[key], from[key]);\n              }\n            } else {\n              to[key] = from[key];\n            }\n          }\n        }\n      }\n    };\n\n    mergeOptionsDeep(toArg, newOptions);\n    return toArg;\n  }\n  /**\n   * Subscribe user callback on time changed.\n   */\n  public onTimeChanged(callback: (eventArgs: TimelineTimeChangedEvent) => void): void {\n    this.on(TimelineEvents.TimeChanged, callback);\n  }\n  /**\n   * Subscribe user callback on drag started event.\n   */\n  public onDragStarted(callback: (eventArgs: TimelineDragEvent) => void): void {\n    this.on(TimelineEvents.DragStarted, callback);\n  }\n  /**\n   * Subscribe user callback on drag event.\n   */\n  public onDrag(callback: (eventArgs: TimelineDragEvent) => void): void {\n    this.on(TimelineEvents.Drag, callback);\n  }\n  /**\n   * Subscribe user callback on drag finished event.\n   */\n  public onDragFinished(callback: (eventArgs: TimelineDragEvent) => void): void {\n    this.on(TimelineEvents.DragFinished, callback);\n  }\n  /**\n   * Subscribe user callback on double click.\n   */\n  public onDoubleClick(callback: (eventArgs: TimelineClickEvent) => void): void {\n    this.on(TimelineEvents.DoubleClick, callback);\n  }\n  /**\n   * Subscribe user callback on keyframe changed event.\n   */\n  public onKeyframeChanged(callback: (eventArgs: TimelineKeyframeChangedEvent) => void): void {\n    this.on(TimelineEvents.KeyframeChanged, callback);\n  }\n  /**\n   * Subscribe user callback on drag finished event.\n   */\n  public onMouseDown(callback: (eventArgs: TimelineClickEvent) => void): void {\n    this.on(TimelineEvents.MouseDown, callback);\n  }\n\n  /**\n   * Subscribe user callback on selected.\n   */\n  public onSelected(callback: (eventArgs: TimelineSelectedEvent) => void): void {\n    this.on(TimelineEvents.Selected, callback);\n  }\n  /**\n   * Subscribe user callback on scroll event\n   */\n  public onScroll(callback: (eventArgs: TimelineScrollEvent) => void): void {\n    this.on(TimelineEvents.Scroll, callback);\n  }\n  public onScrollFinished(callback: (eventArgs: TimelineScrollEvent) => void): void {\n    this.on(TimelineEvents.ScrollFinished, callback);\n  }\n  _emitScrollEvent(args: MouseEvent | null, scrollProgrammatically: boolean, eventType = TimelineEvents.Scroll): TimelineScrollEvent {\n    const scrollEvent = {\n      args: args,\n      scrollProgrammatically: scrollProgrammatically,\n      scrollLeft: this.getScrollLeft(),\n      scrollTop: this.getScrollTop(),\n      scrollHeight: this._scrollContainer.scrollHeight,\n      scrollWidth: this._scrollContainer.scrollWidth,\n    } as TimelineScrollEvent;\n    super.emit(eventType, scrollEvent);\n    return scrollEvent;\n  }\n  _emitKeyframeChanged(element: TimelineElementDragState, source: TimelineEventSource = TimelineEventSource.Programmatically): TimelineKeyframeChangedEvent {\n    const args = new TimelineKeyframeChangedEvent();\n    args.val = element.val;\n    args.prevVal = element.prevVal;\n    args.target = element;\n    args.source = source;\n    this.emit(TimelineEvents.KeyframeChanged, args);\n    return args;\n  }\n  _emitDragStartedEvent(): TimelineDragEvent {\n    const args = this._getDragEventArgs();\n    this.emit(TimelineEvents.DragStarted, args);\n    if (args.isPrevented()) {\n      this._preventDrag(args, this._drag, true);\n    }\n    return args;\n  }\n  /**\n   * Private emit timeline event that dragging element is finished.\n   * @param forcePrevent - needed when during dragging components set to the state when they cannot be dragged anymore. (used only as recovery state).\n   * @returns\n   */\n  _emitDragFinishedEvent(forcePrevent = false): TimelineDragEvent {\n    if (this._drag && this._drag.changed) {\n      const args = this._getDragEventArgs();\n      if (forcePrevent) {\n        args.preventDefault();\n      }\n      this.emit(TimelineEvents.DragFinished, args);\n      if (args.isPrevented()) {\n        this._preventDrag(args, this._drag, true);\n      }\n      return args;\n    }\n\n    return null;\n  }\n  _preventDrag(dragArgs: TimelineDragEvent, data: TimelineDraggableData, toStart = false): void {\n    if (dragArgs.elements) {\n      dragArgs.elements.forEach((element) => {\n        const toSet = toStart ? element.startedVal : element.prevVal;\n        this._setKeyframePos(element, toSet);\n      });\n    }\n    data.val = data.prevVal;\n    dragArgs.val = dragArgs.prevVal;\n  }\n  _emitDragEvent(): TimelineDragEvent {\n    if (!this._drag) {\n      return null;\n    }\n    const args = this._getDragEventArgs();\n    this.emit(TimelineEvents.Drag, args);\n    if (args.isPrevented()) {\n      this._preventDrag(args, this._drag, false);\n    }\n    return args;\n  }\n  _emitKeyframesSelected(state: TimelineSelectionResults): TimelineSelectedEvent {\n    const args = new TimelineSelectedEvent();\n    args.selected = state.selected;\n    args.changed = state.changed;\n    this.emit(TimelineEvents.Selected, args);\n    return args;\n  }\n  _getDragEventArgs(): TimelineDragEvent {\n    const draggableArguments = new TimelineDragEvent();\n    if (this._currentPos) {\n      draggableArguments.val = this._currentPos.val;\n      draggableArguments.originalVal = this._currentPos.originalVal;\n      draggableArguments.snapVal = this._currentPos.snapVal;\n      draggableArguments.pos = this._currentPos;\n    }\n    if (this._drag) {\n      draggableArguments.elements = this._drag.elements;\n      draggableArguments.target = this._drag.target;\n    } else {\n      draggableArguments.elements = [];\n      draggableArguments.target = null;\n    }\n    return draggableArguments;\n  }\n}\n","// bundle entry point\n\nexport * from './timeline';\nexport * from './timelineModel';\nexport * from './timelineRow';\nexport * from './timelineKeyframe';\nexport * from './timelineEventsEmitter';\nexport * from './settings/timelineConsts';\nexport * from './timelineRanged';\n\n// @public styles\nexport * from './settings/timelineOptions';\nexport * from './settings/styles/timelineKeyframeStyle';\nexport * from './settings/styles/timelineRowStyle';\nexport * from './settings/styles/timelineStyle';\n\nexport * from './utils/timelineStyleUtils';\nexport * from './utils/timelineUtils';\nexport * from './utils/timelineElement';\n\n// @private helper containers.\nexport * from './utils/selectable';\nexport * from './utils/timelineCutBoundsRectResults';\nexport * from './utils/timelineSelectionResults';\nexport * from './utils/timelineValues';\nexport * from './utils/timelineMouseData';\nexport * from './utils/timelineElementDragState';\nexport * from './utils/timelineDraggableData';\n\n// @private virtual model\nexport * from './utils/timelineModelCalcResults';\nexport * from './utils/timelineCalculatedRow';\nexport * from './utils/timelineCalculatedGroup';\nexport * from './utils/timelineCalculated';\nexport * from './utils/timelineCalculatedKeyframe';\n\n// @public events\nexport * from './utils/events/timelineKeyframeChangedEvent';\nexport * from './utils/events/timelineTimeChangedEvent';\nexport * from './utils/events/timelineSelectedEvent';\nexport * from './utils/events/timelineScrollEvent';\nexport * from './utils/events/timelineClickEvent';\nexport * from './utils/events/timelineDragEvent';\n\n// @public enums\nexport * from './enums/timelineKeyframeShape';\nexport * from './enums/timelineInteractionMode';\nexport * from './enums/timelineScrollSource';\nexport * from './enums/timelineElementType';\nexport * from './enums/timelineCursorType';\nexport * from './enums/timelineCapShape';\nexport * from './enums/timelineEventSource';\nexport * from './enums/timelineSelectionMode';\nexport * from './enums/timelineEvents';\n// @private defaults are exposed:\nexport * from './settings/defaults';\n"],"names":["TimelineEventsEmitter","topic","callback","_subscriptions","push","filter","event","length","args","forEach","TimelineKeyframeShape","TimelineStyleUtils","keyframeStyle","rowStyle","options","propertyName","defaultValue","reverseOrder","styles","style","undefined","value","keyframesStyle","globalRowStyle","rowsStyle","results","keyframe","shape","getKeyframeStyle","Rhomb","color","getRowStyle","headerHeight","denominators","TimelineUtils","ctx","x1","y1","x2","y2","moveTo","lineTo","val","isNaN","Number","isFinite","array","element","index","indexOf","splice","x","y","rectangle","width","height","originalStep","divisionCheck","step","lastDistance","pow","getPowArgument","i","denominator","calculatedStep","Math","distance","getDistance","min","max","isNumber","to","from","shrink","fromMin","getMin","toMin","isFromMinNumber","isToMinNumber","fromMax","getMax","toMax","isFromMaxNumber","isToMaxNumber","rect","rect2","console","log","sqrt","abs","p","window","getSelection","removeAllRanges","doc","document","selection","empty","toCheck","category","s","sign","floor","zerosCount","TimelineBaseEvent","_prevented","TimelineKeyframeChangedEvent","TimelineEventSource","TimelineTimeChangedEvent","User","TimelineSelectedEvent","TimelineClickEvent","TimelineDragEvent","TimelineInteractionMode","TimelineElementType","TimelineCursorType","TimelineCapShape","TimelineSelectionMode","TimelineEvents","defaultTimelineStyle","marginTop","capWidth","capHeight","capType","Rect","strokeColor","fillColor","defaultTimelineKeyframeStyle","selectedFillColor","selectedStrokeColor","strokeThickness","draggable","defaultTimelineRowStyle","marginBottom","groupFillColor","groupHeight","defaultTimelineOptions","snapAllKeyframesOnMove","snapEnabled","timelineStyle","stepPx","stepVal","stepSmallPx","snapStep","leftMargin","headerFillColor","labelsColor","tickColor","selectionColor","font","zoom","zoomSpeed","zoomMin","zoomMax","controlKeyIsMetaKey","scrollContainerClass","groupsDraggable","keyframesDraggable","timelineInteractive","MAX_VALUE","defaultTimelineConsts","autoPanSpeed","scrollByDragSpeed","clickDetectionMs","doubleClickTimeoutMs","scrollFinishedTimeoutMs","autoPanByScrollPadding","clickThreshold","TimelineScrollSource","Timeline","model","Selection","_interactionMode","Zoom","_setZoomCursor","_cleanUpSelection","rescale","redraw","_scrollAreaClickOrDragStarted","scrollProgrammatically","_scrollProgrammatically","_clearScrollFinishedTimer","_scrollFinishedTimerRef","setTimeout","_isPanStarted","_emitScrollEvent","ScrollFinished","_consts","_controlKeyPressed","preventDefault","mousePos","_getMousePos","_canvas","_zoom","deltaY","_options","_scrollContainer","scrollTop","isDoubleClick","Date","now","_lastClickTime","clearBrowserSelection","_startPos","_trackMousePos","_lastClickPoint","_scrollStartPos","scrollLeft","_clickAllowed","onlyElements","NonInteractivePan","None","elements","elementFromPoint","radius","target","_filterDraggableElements","pos","originalVal","snapVal","DoubleClick","MouseDown","_clickTimeout","isPrevented","_currentPos","_drag","changed","_setElementDragState","type","Keyframe","_startedDragWithCtrl","_startedDragWithShiftKey","shiftKey","selected","_selectInternal","getSelectedElements","map","Group","keyframes","Array","isArray","_convertToElement","row","_lastUsedArgs","isTouch","changedTouches","_selectionRect","_clickTimeoutIsOver","_selectionRectEnabled","isLeftClicked","isLeftButtonClicked","convertedVal","_setTimeInternal","offset","movedOffset","_moveElements","prevVal","eventArgs","_emitDragStartedEvent","_emitDragEvent","Pan","_setCursor","Grabbing","_scrollByPan","_scrollBySelectionOutOfBounds","Grab","Default","cursor","EWResize","Pointer","direction","_performClick","_getKeyframesByRectangle","selectionMode","Append","Normal","select","_ctx","valToPx","_val","scrollWidth","_renderBackground","_renderRows","_renderHeaderBackground","_renderTicks","_renderKeyframes","_renderSelectionRect","_renderTimeline","_cloneOptions","initialize","_model","id","Error","_generateContainers","_setOptions","_subscribeComponentEvents","HTMLElement","_container","getElementById","createElement","_scrollContent","getContext","position","cssText","appendChild","scrollBarWidth","offsetWidth","clientWidth","_unsubscribeComponentEvents","addEventListener","_handleWheelEvent","_handleScrollEvent","_handleScrollMouseDownEvent","_handleKeyUp","_handleKeyDown","_handleBlurEvent","_handleWindowResizeEvent","_handleMouseDownEvent","_handleMouseMoveEvent","_handleMouseUpEvent","removeEventListener","warn","offAll","_stopAutoPan","e","ZoomOut","ZoomIn","clearTimeout","metaKey","ctrlKey","speed","deltaSpeed","_width","diff","_fromScreen","_currentZoom","_setZoom","zoomCenter","newScrollLeft","round","_rescaleInternal","ZoomMode","setScrollLeft","keepInBounds","prevZoom","getZoom","zoomSet","state","startedVal","buttons","source","Programmatically","isChanged","bounds","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","setMinMax","currentBounds","expectedKeyframeValue","newPosition","toSet","newValue","_setKeyframePos","clientHeight","screenRect","keyframesModels","_forEachKeyframe","calcKeyframe","isOverlap","size","drag","mode","Revert","selectionChanged","_emitKeyframeChanged","data","_mapKeyframes","parentRow","getAllKeyframes","node","selectable","nodes","getSelectedKeyframes","nodesArray","_changeNodeState","deleteElement","selectedItems","exists","_emitKeyframesSelected","calculatedModel","_calculateModel","rows","calcRow","nextRow","keyframeIndex","canvas","mouseArgs","_mousePosToVal","getScrollLeft","getScrollTop","forcePrevent","_emitDragFinishedEvent","_intervalRef","setInterval","clearInterval","_autoPanLastActionDate","start","scrollStartPos","offsetX","newLeft","speedX","speedY","isLeft","isRight","isTop","isBottom","_height","newWidth","newHeight","_startAutoPan","_checkUpdateSpeedTooFast","scrollSpeedMultiplier","ScrollBySelection","setScrollTop","px","steps","_leftMargin","pxToVal","stops","stepsFit","minSteps","minOffset","ms","isSeconds","seconds","year","days","hours","minutes","str","rulerActive","screenWidth","wasToVal","valDistance","findGoodStep","smallStep","fromVal","toVal","ceil","lastTextStart","save","tickHeight","smallTickHeight","sharpPos","_getSharp","_toScreenPx","beginPath","setLineDash","lineWidth","strokeStyle","drawLine","stroke","fillStyle","text","_formatUnitsText","textSize","measureText","textX","fillText","restore","nextSharpPos","_pixelRatio","toReturn","rowAbsoluteHeight","hidden","rowHeight","getRowHeight","getRowMarginBottom","currentRowY","groups","currentGroup","existingGroup","group","keyframeSize","_getKeyframePosition","parentGroup","groupRect","_getKeyframesGroupSize","rowCalc","getRowFillColor","_cutBounds","fillRect","keyframeLaneColor","rectBounds","minX","maxX","minY","maxY","isRectOverlap","offsetW","offsetH","overlapY","overlapX","rowY","minValue","maxValue","rowGroupHeight","margin","xMin","xMax","rowCalculated","rowSize","clip","keyframeShape","keyframeColor","keyframeSelectedFillColor","keyframeFillColor","border","keyframeStrokeThickness","keyframeSelectedStrokeColor","keyframeStrokeColor","translate","rotate","PI","fill","Circle","arc","thickness","strokeRect","clearRect","timeLinePos","rectSize","Triangle","closePath","requestAnimationFrame","_redrawInternal","posY","timelineEvent","emit","TimeChanged","SetTimeMethod","classList","contains","add","background","_mergeOptions","_applyContainersStyles","clientX","clientY","touch","radiusX","radiusY","getBoundingClientRect","scaleX","scaleY","left","top","setTransform","scrollMode","DefaultMode","_updateCanvasScale","additionalOffset","timelineGlobalPos","timelinePos","rightPosition","getClientWidth","keyframeW","minWidthPx","minWidth","h","minHeight","getPriority","filteredElements","keyframeDraggable","groupDraggable","Row","sortDraggable","a","b","prioA","prioB","sorted","sort","clickRadius","onlyTypes","snap","isNextRow","rowOverlapped","keyframesGroupOverlapped","groupElement","snapped","keyframePos","dist","includes","previousOptions","JSON","parse","stringify","newOptions","toArg","mergeOptionsDeep","key","Object","prototype","hasOwnProperty","call","on","DragStarted","Drag","DragFinished","KeyframeChanged","Selected","Scroll","eventType","scrollEvent","scrollHeight","_getDragEventArgs","_preventDrag","dragArgs","toStart","draggableArguments"],"sourceRoot":""}